
# The following flags are defined to have a meaning
#
# * base : the corresponding tile has already graphics for the terrain
# base. No other one should be added.
# * transition-$direction : the corresponding tile already has the transition
# in the given direction (or should not have one). No other one should be
# added.
# * keep-of-$castle : castle being a tile letter. The corresponding tile is the
# keep correspoding to the given castle tile

# Use the following layers:
# -1000                : terrain base graphics
# -200 to -101         : stacked flat adjacent transitions
# -100                 : buildings
# -90                  : "northern" transitions
# -80                  : terrain overlays
# -50                  : castle walls
# -30                  : castle transitions

# Loads the macros used in the file
{terrain-graphics}

# Castle-specific transitions. Those are placed before base terrains, as they
# override the normal base terrain.
{CASTLE_TRANSITION CK f forest-ctrans}
#Special cases for encampment (nw, nw-n-ne and ne)
{CASTLE_TRANSITION nK f forest-etrans}
#On the rest fall back on forest-castle
{CASTLE_TRANSITION nK f forest-ctrans}

#
# Attachs graphics to each known terrain types
#

{TERRAIN_BASE_PROB            u cave-floor4         10}
{TERRAIN_BASE_PROB            u cave-floor3         2}
{TERRAIN_BASE_PROB            u cave-floor2         10}
{TERRAIN_BASE                 u cave-floor1}
{TERRAIN_BASE                 W cavewall}
{TERRAIN_BASE_PROB_OV         f forest2             10}
{TERRAIN_BASE_PROB_OV         f forest3             10}
{TERRAIN_BASE_PROB_OV         f forest4             10}
{TERRAIN_BASE_PROB_OV         f forest5             10}
{TERRAIN_BASE_PROB_OV         f forest6             10}
{TERRAIN_BASE_PROB_OV         f forest7             10}
{TERRAIN_BASE_PROB_OV         f forest8             10}
{TERRAIN_BASE_PROB_OV         f forest-stones1      1}
{TERRAIN_BASE_PROB_OV         f forest-stones2      2}
{TERRAIN_BASE_PROB_OV         f forest-stones3      1}
{TERRAIN_BASE_PROB_OV         f forest-stones4      1}
{TERRAIN_BASE_OV              f forest}
{TERRAIN_BASE_PROB            m mountains-peak1     33}
{TERRAIN_BASE_PROB            m mountains-peak2     33}
{TERRAIN_BASE                 m mountains}
{TERRAIN_BASE_PROB            H snow-hills3         30}
{TERRAIN_BASE_PROB            H snow-hills2         30}
{TERRAIN_BASE                 H snow-hills}
{TERRAIN_BASE_PROB            h hills-variation1    15}
{TERRAIN_BASE_PROB            h hills-variation2    15}
{TERRAIN_BASE_PROB            h hills-variation3    30}
{TERRAIN_BASE                 h hills}
{TERRAIN_BASE_PROB            SF snow2 30}
{TERRAIN_BASE_PROB            SF snow3 30}
{TERRAIN_BASE                 SF snow}
{TERRAIN_BASE_PROB_OV         F snow-forest2        30}
{TERRAIN_BASE_PROB_OV         F snow-forest3        30}
{TERRAIN_BASE_OV              F snow-forest}
{TERRAIN_BASE_PROB            g grassland-rocks1    2}
{TERRAIN_BASE_PROB            g grassland-rocks2    2}
{TERRAIN_BASE_PROB            g grassland-flowers1  3}
{TERRAIN_BASE_PROB            g grassland-flowers2  3}
{TERRAIN_BASE_PROB            gf grassland-r1 20}
{TERRAIN_BASE_PROB            gf grassland-r2 20}
{TERRAIN_BASE_PROB            gf grassland-r3 20}
{TERRAIN_BASE                 gf grassland-r4}
{TERRAIN_BASE                 r dirt}
{TERRAIN_BASE                 R road}
{TERRAIN_BASE_PROB            d desert-plant        10}
{TERRAIN_BASE                 d desert}
{TERRAIN_BASE                 i ice}
{TERRAIN_BASE_PROB            w swampwater2         30}
{TERRAIN_BASE_PROB            w swampwater3         30}
{TERRAIN_BASE                 w swampwater}
{TERRAIN_BASE                 p pier}
{TERRAIN_BASE_PROB            c\|/ coast3        30}
{TERRAIN_BASE_PROB            c\|/ coast2        30}
{TERRAIN_BASE                 c\|/ coast}
{TERRAIN_BASE_PROB            s ocean3         30}
{TERRAIN_BASE_PROB            s ocean2         30}
{TERRAIN_BASE                 s ocean}
{TERRAIN_BASE                 ~ fog}

{CANYON X canyon}
{BRIDGE \ | / cs bridge}

#
# Villages
#

{TERRAIN_BASE Y swampwater}
{TERRAIN_BASE V snow}
{TERRAIN_BASE Z coast}
{TERRAIN_BASE v grassland-r1}
{TERRAIN_BASE D cave-floor1}
{TERRAIN_BASE t grassland-r1}

{BUILDING Y ({VIMG       36,40 village-swampwater })}
{BUILDING V ({VIMG       36,40 village-snow       })}
{BUILDING Z ({VIMG       36,40 village-coast      })}
{BUILDING v ({VIMG       36,40 village-human      })}
{BUILDING D ({VIMG       36,40 dwarven-village    })}
{BUILDING t ({VIMG_NIGHT 36,40 village village-dusk,village-dusk2,village-dusk3,village-dusk4})} 

#
# Transition between terrains
#

# Special transitions go first

# Castle and keeps. Always use the same letter for keeps: the CASTLE_AND_KEEP
# macro will determine the correct graphics to use, according to the adjacent
# castle letter.

# Flags the keep, they must be flagged to be recognized by the
# {CASTLE_AND_foo_KEEP} macros

{FLAG_IF_ADJACENT K C keep-of-C keep-flag}
{FLAG_IF_ADJACENT K n keep-of-n keep-flag}
{FLAG_IF_ADJACENT K o keep-of-o keep-flag}
{FLAG_REMAINING   K   keep-of-C keep-flag}

#
# Castles base terrains
#

{DISABLE_TRANSITIONS K}

{TERRAIN_BASE C castle}
{TERRAIN_BASE o dwarven-castle-floor}
{TERRAIN_BASE n dirt}
{TERRAIN_BASE O orccastle}
{TERRAIN_BASE_FLAG K keep-of-C castle}
{TERRAIN_BASE_FLAG K keep-of-o dwarven-keep-floor}
{TERRAIN_BASE_FLAG K keep-of-n dirt}

# Loyalist castle
{DISABLE_TRANSITIONS C}
{TERRAIN_ADJACENT_CORNER       C      !CK    !CK     52,76 castle-convex}
{TERRAIN_ADJACENT_CORNER       !CK    C      C       56,68 castle-concave}
{TERRAIN_ADJACENT_CORNER       K      C      C       54,72 keep-inside}
{TERRAIN_ADJACENT_CORNER_FLAG1 K      !CK    !CK     52,76 keep-of-C keep-wall}
{TERRAIN_ADJACENT_CORNER       K      !CK    C       52,72 keep-wall-0}
{TERRAIN_ADJACENT_CORNER       K      C      !CK     56,76 keep-wall-1} 

# Encampments
{DISABLE_TRANSITIONS n}
{TERRAIN_ADJACENT_CORNER       n      !nK    !nK     52,76 encampment-convex}
{TERRAIN_ADJACENT_CORNER       !nK    n      n       56,68 encampment-concave}
{TERRAIN_ADJACENT_CORNER_FLAG1 K      !nK    !nK     52,76 keep-of-n encampment-convex}
{TERRAIN_ADJACENT_CORNER       !nK    K      n       52,76 encampment-concave}
{TERRAIN_ADJACENT_CORNER       !nK    n      K       52,76 encampment-concave}

# Cave and dwarven castles
{DISABLE_TRANSITIONS W}
{DISABLE_TRANSITIONS o}
{TERRAIN_ADJACENT_CORNER       W      !WoK   !WoK    54,72 cavewall-convex}
{TERRAIN_ADJACENT_CORNER       !WoK   W      W       54,72 cavewall-concave}
{TERRAIN_ADJACENT_CORNER       o      !WoK   !WoK    54,72 dwarven-castle-convex}
{TERRAIN_ADJACENT_CORNER       !WoK   o      o       54,72 dwarven-castle-concave}
{TERRAIN_ADJACENT_CORNER_FLAG1 K      !WoK   !WoK    54,72 keep-of-o dwarven-castle-convex}
{TERRAIN_ADJACENT_CORNER       !WoK   K      o       54,72 dwarven-castle-concave}
{TERRAIN_ADJACENT_CORNER       !WoK   o      K       54,72 dwarven-castle-concave}
{TERRAIN_ADJACENT_CORNER       oK     W      W       54,72 dwarven-castle-wall-convex}
{TERRAIN_ADJACENT_CORNER       W      oK     oK      54,72 dwarven-castle-wall-concave}
{TERRAIN_ADJACENT_CORNER       oK     W      !WoK    54,72 dwarven-castle-wall-cw}
{TERRAIN_ADJACENT_CORNER       oK     !WoK   W       54,72 dwarven-castle-wall-ccw}

# Orcish castle
{DISABLE_TRANSITIONS O}
{TERRAIN_ADJACENT_CORNER       O      !O     !O      54,72 orccastle-convex}
{TERRAIN_ADJACENT_CORNER       !O     O      O       54,72 orccastle-concave}
#{TERRAIN_ADJACENT_CORNER   -50        K      O      O       <name>}
#{TERRAIN_ADJACENT_CORNER_FLAG1 -50    K      !OK    !OK     keep-of-O <name>}
#{TERRAIN_ADJACENT_CORNER   -50        K      O      !OK     <name>}
#{TERRAIN_ADJACENT_CORNER   -50        K      !OK    O       <name>} 

# Castle decorations and castle floors. Those must always be after the castles
# are defined.
{BUILDING_FLAG K ({VIMG 36,40 tent}) keep-of-n}
{BUILDING_FLAG K ({VIMG 36,40 dwarven-keep}) keep-of-o}

# Forest, hills and mountains should always overlay on northern sides
#{TERRAIN_ADJACENT_NORTH    -90        m  !m   mountains}
#{TERRAIN_ADJACENT_NORTH    -90        H  !H   snow-hills}
#{TERRAIN_ADJACENT_NORTH    -90        h  !hm  hills} # No adj-north between hills and mountains

{TERRAIN_ADJACENT_OV       -186        f      !f      forest}
{TERRAIN_ADJACENT_OV       -187        F      !F      snow-forest}
{TERRAIN_ADJACENT          -188        m      !m      mountains}
{TERRAIN_ADJACENT          -189        H      !H      snow-hills}
{TERRAIN_ADJACENT          -190        h      !h      hills}
{TERRAIN_ADJACENT          -191        uD     !uD     cave-floor}
{TERRAIN_ADJACENT          -192        SVF    !SVF    snow}
{TERRAIN_ADJACENT          -193        ftgvX   !ftgvX   grassland}
{TERRAIN_ADJACENT          -194        r      !r      dirt}
{TERRAIN_ADJACENT          -195        R      !R      road}        # Missing gfx
{TERRAIN_ADJACENT          -196        d      !d      desert}
{TERRAIN_ADJACENT          -197        i      !i      ice}
{TERRAIN_ADJACENT          -198        Yw     !Yw     swampwater}
{TERRAIN_ADJACENT          -199        cZp\|/ !cZp\|/ coast}
{TERRAIN_ADJACENT          -200        s      !s      ocean}

{TERRAIN_BASE_DEFAULT void}


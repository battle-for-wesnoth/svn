#textdomain wesnoth-multiplayer

# wmllint: local spelling Kah Ruuk Oni Onis
[test]
    id=ai_arena_small
    name= _ "AI Arena - small"
    description= _ "This most unusual of caves was once known as the Chamber of Laughing Devils, and was the inner citadel of the Kah Ruuk Oni. The Kah Ruuk were a wicked and cunning race of man-eating demons, who terrorized the people of the Eastern Lands for nearly four hundred years, before vanishing from Irdya without a trace. Since that time, many factions have vied for dominion over the Den of Onis, hoping to unlock the strange and mysterious magics of its creators."
    map_data="{ai/maps/scenario-AI_Arena_small.map}"
    random_start_time="no"
    turns=-1

    {DEFAULT_SCHEDULE}
    {DEFAULT_MUSIC_PLAYLIST}

    {PLACE_IMAGE items/burial.png 15 13}
    {PLACE_IMAGE items/burial.png 26 16}
    {PLACE_IMAGE items/burial.png 4 9}
    {ai/scenarios/ai_arena_small/}

    [event]
        name=preload
        [set_variable]
            name=test_path_to_ai
            value=ai/ais/default_ai.cfg
        [/set_variable]
        [set_variable]
            name=test_path_to_idle_ai
            value=ai/dev/idle_ai.cfg
        [/set_variable]
        [set_variable]
            name=test_path_to_default_ai
            value=ai/ais/default_ai.cfg
        [/set_variable]
        [set_variable]
            name=test_path_to_formula_ai
            value=ai/ais/formula_ai.cfg
        [/set_variable]
        [set_variable]
            name=test_id
            value=2
        [/set_variable]

        [set_menu_item]
            id=repeat_test
            description="Repeat last test"
            [command]
                [fire_event]
                    name="_clean_arena"
                [/fire_event]
                [fire_event]
                    name="_setup_test"
                [/fire_event]
            [/command]
        [/set_menu_item]

        [set_menu_item]
            id=select_another_ai
            description="Select another ai"
            [command]
                [fire_event]
                    name=_select_challenger_ai
                [/fire_event]
            [/command]
        [/set_menu_item]

        [set_menu_item]
            id=select_test
            description="Select another test"
            [command]
                [fire_event]
                    name=_select_test
                [/fire_event]
            [/command]
        [/set_menu_item]
    [/event]

    [side]
        side=1
        name="AI Developer"
        type=Nightgaunt
        canrecruit=yes
        controller=human
        team_name=master
        user_team_name= _ "teamname^Master"
        fog=no
        [modifications]
            {TRAIT_INTELLIGENT}
            {TRAIT_QUICK}
            {TRAIT_LOYAL}
        [/modifications]
    [/side]
    [side]
        side=2
        name="Challenger AI"
        type=White Mage
        canrecruit=yes
        controller=ai
        team_name=north
        user_team_name= _ "teamname^North"
        fog=yes
    [/side]
    [side]
        side=3
        name="Champion AI"
        type=Dark Adept
        canrecruit=yes
        controller=ai
        team_name=south
        user_team_name= _ "teamname^South"
        fog=yes
    [/side]

    [event]
        name=_select_test
        first_time_only=no
        [message]
            speaker=narrator
            message=_ "Which test do you want to run, oh Mightly AI Developer ?"
            [option]
                message=_ "Repeat last test [$test_id]"
            [/option]
            [option]
                message=_ "Clean the Arena [0]"
                [command]
                    [set_variable]
                        name=test_id
                        value=0
                    [/set_variable]
                [/command]
            [/option]
            [option]
                message=_ "Healing: Simple healing use [1]"
                [command]
                    [set_variable]
                        name=test_id
                        value=1
                    [/set_variable]
                [/command]
            [/option]
            [option]
                message=_ "Poison: Spreading poison around [2]"
                [command]
                    [set_variable]
                        name=test_id
                        value=2
                    [/set_variable]
                [/command]
            [/option]
        [/message]
        [command]
            [fire_event]
                name="_clean_arena"
            [/fire_event]
        [/command]
        [command]
            [fire_event]
                name="_setup_test"
            [/fire_event]
        [/command]
    [/event]

    [event]
        name=_select_challenger_ai
        first_time_only=no

        [message]
            speaker=narrator
            message=_ "Which AI do you want to use, oh Mightly AI Developer ?"
            [option]
                message=_ "I am happy with the current AI of team 2, [$test_path_to_ai]"
            [/option]
            [option]
                message=_ "My AI is DEFAULT AI, and it strikes fear into the hearts of mortals."
                [command]
                    [set_variable]
                        name=test_path_to_ai
                        value=$test_path_to_default_ai
                    [/set_variable]
                [/command]
            [/option]
            [option]
                message=_ "I am the king of FORMULA AI, and I will use its vast powers for world domination."
                [command]
                    [set_variable]
                        name=test_path_to_ai
                        value=$test_path_to_formula_ai
                    [/set_variable]
                [/command]
            [/option]
            [option]
                message=_ "I've come with my own AI, and I am ready to test its strength"
                [command]
                    [message]
                        speaker=unit
                        message=_ "and where is it located ? (path follows the usual WML convention)"
                        [text_input]
                            label=_ "AI Location:"
                            variable="test_path_to_ai"
                        [/text_input]
                    [/message]
                [/command]
            [/option]
            [option]
                message=_ "I want to test formulaAI-based poisoning improvements written by Velory"
                [command]
                    [set_variable]
                        name=test_path_to_ai
                        value=ai/dev/formula_ai_poisoning.cfg
                    [/set_variable]
                [/command]
            [/option]
        [/message]
        [command]
            [fire_event]
                name="_replace_ai_2"
            [/fire_event]
        [/command]
        [command]
            {TELEPORT_TILE 6 21 5 22}
        [/command]
    [/event]

    [event]
        name=_clean_arena
        first_time_only=no
        [kill]
            animate=no
            fire_event=no
            canrecruit=no
        [/kill]
        [capture_village]
            x,y=5,9
        [/capture_village]
        [capture_village]
            x,y=6,19
        [/capture_village]
        [capture_village]
            x,y=9,17
        [/capture_village]
        [capture_village]
            x,y=10,20
        [/capture_village]
        [capture_village]
            x,y=11,4
        [/capture_village]
        [capture_village]
            x,y=14,8
        [/capture_village]
        [capture_village]
            x,y=16,17
        [/capture_village]
        [capture_village]
            x,y=19,22
        [/capture_village]
        [capture_village]
            x,y=20,5
        [/capture_village]
        [capture_village]
            x,y=21,9
        [/capture_village]
        [capture_village]
            x,y=24,6
        [/capture_village]
        [capture_village]
            x,y=25,17
        [/capture_village]
        [label]
            x="9"
            y="17"
        [/label]
        [label]
            x="19"
            y="6"
        [/label]
        [label]
            x="25"
            y="19"
        [/label]
        [label]
            x="26"
            y="14"
        [/label]
        [modify_side]
            side=1
            gold=10000
        [/modify_side]
        [modify_side]
            side=2
            gold=10000
        [/modify_side]
        [modify_side]
            side=3
            gold=10000
        [/modify_side]
    [/event]

    [event]
        name=_setup_test
        first_time_only=no
        [switch]
            variable=test_id
            [case]
                value="0"
                [message]
                    speaker=narrator
                    image=wesnoth-icon.png
                    message=_ "The Arena has been cleaned..."
                [/message]
            [/case]
            [case]
                value="1"
                [fire_event]
                    name=test_0001
                [/fire_event]
            [/case]
            [case]
                value="2"
                [fire_event]
                    name=test_0002
                [/fire_event]
            [/case]
            [else]
                [message]
                    speaker=narrator
                    message=_ "sadly, this test is not yet known in the land of Wesnoth..."
                    image=wesnoth-icon.png
                [/message]
            [/else]
        [/switch]
        [fire_event]
            name="_replace_ai_2"
        [/fire_event]
    [/event]

    [event]
        name=_replace_ai_2
        first_time_only=no
        [modify_side]
            side=2
            switch_ai=$test_path_to_ai
        [/modify_side]
        [message]
            speaker=narrator
            message=_ "and so, the AI for team 2 was redeployed from file '$test_path_to_ai'"
        [/message]
    [/event]
[/test]

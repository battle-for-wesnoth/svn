[unit]
	id=Elvish Scout
	name= _ "Elvish Scout"
	image="units/elves-wood/scout.png"
	{MAGENTA_IS_THE_TEAM_COLOR}
	ellipse="misc/ellipse"
	race=elf
	hitpoints=32
	movement_type=woodland
#mostly like a foot Elf, but they
#are bad at defending in villages
#they are weak against piercing attacks
	movement=9
	experience=32
	level=1
	alignment=neutral
	advanceto=Elvish Rider
	cost=18
	undead_variation=mounted
	usage=scout
	unit_description= _ "The horsemen of the wood elves have some skill with bow and sword, but their true skill lies in their horsemanship. Even other elves are somewhat taken by their uncanny speed in the woods, and their ability to dart through the thick of the forest with nary a scratch. They are, perhaps, some of the only cavalry in existence that fares better in the woods than on open ground."
	die_sound=horse-die.ogg
	[defense]
		village=60
		forest=40
	[/defense]
	[resistance]
		pierce=120
	[/resistance]
	[attack]
		name=grab
		[specials]
			{WEAPON_SPECIAL_THROW (Elvish Scout) grab}
		[/specials]
		icon=attacks/sword-elven.png
		type=blade
		range=melee
		damage=4
		number=3
		[animation]
			hits=yes
			[frame]
				begin=-200
				end=-175
				image="units/elves-wood/scout.png"
				sound=horse-elf-canter.wav
			[/frame]
			[frame]
				begin=-175
				end=-100
				image="units/elves-wood/scout-moving.png"
			[/frame]
			[frame]
				begin=-100
				end=100
				image="units/elves-wood/scout-attack.png"
				sound={SOUND_LIST:SWORD_SWISH}
			[/frame]
			[frame]
				begin=100
				end=175
				image="units/elves-wood/scout-moving.png"
			[/frame]
			[frame]
				begin=175
				end=200
				image="units/elves-wood/scout.png"
			[/frame]
		[/animation]
		[animation]
			hits=no
			[frame]
				begin=-200
				end=-175
				image="units/elves-wood/scout.png"
				sound=horse-elf-canter.wav
			[/frame]
			[frame]
				begin=-175
				end=-100
				image="units/elves-wood/scout-moving.png"
			[/frame]
			[frame]
				begin=-100
				end=100
				image="units/elves-wood/scout-attack.png"
				sound={SOUND_LIST:MISS}
			[/frame]
			[frame]
				begin=100
				end=175
				image="units/elves-wood/scout-moving.png"
			[/frame]
			[frame]
				begin=175
				end=200
				image="units/elves-wood/scout.png"
			[/frame]
		[/animation]
	[/attack]
	[attack]
		name=bow
		icon=attacks/bow-elven.png
		type=pierce
		range=ranged
		damage=6
		number=2
		[animation]
			hits=no
			[missile_frame]
				begin=-150
				end=0
				image="projectiles/missile-n.png"
				image_diagonal="projectiles/missile-ne.png"
			[/missile_frame]
			[frame]
				begin=-400
				end=-300
				image="units/elves-wood/scout-attack1.png"
				sound=bow-miss.ogg
			[/frame]
			[frame]
				begin=-300
				end=-50
				image="units/elves-wood/scout-attack2.png"
			[/frame]
			[frame]
				begin=-50
				end=50
				image="units/elves-wood/scout-moving.png"
			[/frame]
		[/animation]
		[animation]
			hits=yes
			[missile_frame]
				begin=-150
				end=0
				image="projectiles/missile-n.png"
				image_diagonal="projectiles/missile-ne.png"
			[/missile_frame]
			[frame]
				begin=-400
				end=-300
				image="units/elves-wood/scout-attack1.png"
				sound=bow.ogg
			[/frame]
			[frame]
				begin=-300
				end=-50
				image="units/elves-wood/scout-attack2.png"
			[/frame]
			[frame]
				begin=-50
				end=50
				image="units/elves-wood/scout-moving.png"
			[/frame]
		[/animation]
	[/attack]
	{DEFENSE_ANIM "units/elves-wood/scout-defend.png" "units/elves-wood/scout.png" {SOUND_LIST:HORSE_HIT} }
	[movement_anim]
		[frame]
			begin=0
			end=150
			image="units/elves-wood/scout-moving.png"
		[/frame]
	[/movement_anim]

#define WEAPON_SPECIAL_THROW TYPE WEAPON
			[damage]
				name= _ "Grab"
				name_inactive= _ "Grab"
				description= _ "When this attack hits, the opponent is grabbed and may be thrown to inflict damage to another adjacent enemy unit."
				description_inactive= _ "When this attack hits, the opponent is grabbed and may be thrown to inflict damage to another adjacent enemy unit."
			[/damage]
		[/specials]
	[/attack]

	[event]
		name=attacker_hits
		first_time_only=no

		[filter]
			type={TYPE}
			weapon=grab
		[/filter]

		[store_unit]
			[filter]
				x,y=$x2,$y2
			[/filter]

			kill=yes
			variable=defender
		[/store_unit]

		[store_unit
			[filter]
				x,y=$x1,$y1
			[/filter]

			kill=no
			variable=attacker
		[/store_unit]

		{VARIABLE_OP throw_damage format "$defender.max_hitpoints"}
		{VARIABLE_OP throw_damage multiply 0.5}

		[object]
			name=throw
			silent=yes

			[filter]
				x,y=$x1,$y1
			[/filter]

			[effect]
				apply_to=new_attack
				range=ranged
				name=throw
				type=impact
				icon=attacks/blank.png
				damage=$throw_damage
				number=1
				[animation]
					[missile_frame]
						image=$defender.image
						begin=-200
						end=0
					[/missile_frame]
					[frame]
						begin=-100
						end=0
						sound=fist.ogg
					[/frame]
				[/animation]
			[/effect]
		[/object]

		{FOREACH attacker.attack i}
			{VARIABLE_OP temp1 format "$attacker.attack[$i].name"}

			[if]
				[variable]
					name=temp1
					equals=grab
				[/variable]

				[then]
					{VARIABLE_OP temp2 format "attacker.attack[$i].attack_weight"}
					{VARIABLE $temp2 "0.0"}
				[/then]
			[/if]
		{NEXT i}

		{VARIABLE_OP temp1 format "$attacker.attack

		{VARIABLE attacker.moves 0}
		{VARIABLE attacker.attacks_left 1}
	[/event]

	[event]
		name=attack_end
		first_time_only=no

		[filter]
			type={TYPE}
			weapon=throw
		[/filter]

		[store_unit]
			[filter]
				x,y=$x1,$y1
			[/filter]

			kill=no
			variable=attacker
		[/store_unit]

		{FOREACH attacker.modifications.object i}
			{VARIABLE_OP temp1 format "$attacker.modifications.object[$i].name"}

			[if]
				[variable]
					name=temp1
					equals=throw
				[/variable]

				[then]
					{VARIABLE_OP temp2 format "attacker.modifications.object[$i]"}
					{CLEAR_VARIABLE $temp2}
				[/then]
			[/if]
		{NEXT i}
	[/event]

	[+attack]
		[+specials]
#enddef
[/unit]

#textdomain wesnoth-trow
[scenario]
    id=Troll_Hole
    name= _ "Troll Hole"
    next_scenario=Elf_Lords
    bonus=yes
    map_data="{campaigns/The_Rise_Of_Wesnoth/maps/Troll_Hole.map}"

    {TURNS 39 36 33}
    {UNDERGROUND}

    {SCENARIO_MUSIC underground.ogg}

    # No story
    {TROLL_HOLE_BIGMAP}

    {TROW_DEATHS}

    [side]
        type=Noble Commander
        id=Prince Haldric
        name= _ "Prince Haldric"
        unrenamable=yes
        side=1
        canrecruit=yes
        controller=human
        shroud=yes
        team_name=Haldric
        user_team_name=_"Refugees"
        {INCOME 8 4 2}
    [/side]

    [side]
        type=Troll Warrior
        id=Erart
        name= _ "Erart"
        side=2
        canrecruit=yes
        {GOLD 100 160 220}
        {INCOME 2 4 8}
        team_name=Troll
        user_team_name=_"Trolls"
#ifdef EASY
        recruit=Troll Whelp
#else
        recruit=Troll Whelp,Troll,Troll Rocklobber
#endif
        [ai]
            {NO_SCOUTS}
            recruitment_ignore_bad_movement=yes
            recruitment_pattern=fighter
            aggression=0.75
            {ATTACK_DEPTH 4 5 5}
        [/ai]
    [/side]

    {STARTING_VILLAGES 2 10}

    [side]
        type=Troll Warrior
        id=Raol
        name= _ "Raol"
        side=3
        canrecruit=yes
        {GOLD 100 160 220}
        {INCOME 2 4 8}
        team_name=Troll
        user_team_name=_"Trolls"
#ifdef EASY
        recruit=Troll Whelp
#else
        recruit=Troll Whelp,Troll,Troll Rocklobber
#endif
        [ai]
            {NO_SCOUTS}
            recruitment_ignore_bad_movement=yes
            recruitment_pattern=fighter
            aggression=0.75
            {ATTACK_DEPTH 4 5 5}
        [/ai]
    [/side]

    {STARTING_VILLAGES 3 10}

    [side]
        type=Troll Warrior
        id=Rilg
        name= _ "Rilg"
        side=4
        canrecruit=yes
        {GOLD 100 160 220}
        {INCOME 2 4 8}
        team_name=Troll
        user_team_name=_"Trolls"
#ifdef EASY
        recruit=Troll Whelp
#else
        recruit=Troll Whelp,Troll,Troll Rocklobber
#endif
        [ai]
            {NO_SCOUTS}
            recruitment_ignore_bad_movement=yes
            recruitment_pattern=fighter
            aggression=0.75
            {ATTACK_DEPTH 4 5 5}
        [/ai]
    [/side]

    {STARTING_VILLAGES 4 10}

    [side]
        type=Troll Warrior
        id=Gulg
        name= _ "Gulg"
        side=5
        canrecruit=yes
        {GOLD 100 160 220}
        {INCOME 2 4 8}
        team_name=Troll
        user_team_name=_"Trolls"
#ifdef EASY
        recruit=Troll Whelp
#else
        recruit=Troll Whelp,Troll,Troll Rocklobber
#endif
        [ai]
            {NO_SCOUTS}
            recruitment_ignore_bad_movement=yes
            recruitment_pattern=fighter
            aggression=0.75
            {ATTACK_DEPTH 4 5 5}
        [/ai]
    [/side]

    {STARTING_VILLAGES 5 10}

    {campaigns/The_Rise_Of_Wesnoth/utils/trow-nlmsg.cfg}

    [event]
        name=prestart

        {PLACE_IMAGE (scenery/rubble.png) 3 14}
        {PLACE_IMAGE (scenery/rubble.png) 25 19}
        {PLACE_IMAGE (scenery/rubble.png) 15 3}
        {PLACE_IMAGE (scenery/rubble.png) 17 27}

        {LOYAL_UNIT 2 (Tentacle of the Deep) 15 11}
        {LOYAL_UNIT 3 (Tentacle of the Deep) 15 20}

#ifdef NORMAL
        {LOYAL_UNIT 4 (Tentacle of the Deep) 11 15}
        {LOYAL_UNIT 5 (Tentacle of the Deep) 19 17}
#endif
#ifdef HARD

        {LOYAL_UNIT 4 (Tentacle of the Deep) 11 15}
        {LOYAL_UNIT 5 (Tentacle of the Deep) 19 17}
        {LOYAL_UNIT 2 (Tentacle of the Deep) 11 17}
        {LOYAL_UNIT 3 (Tentacle of the Deep) 19 15}
#endif

        {RANDOM 1..4}
        [if]
            [variable]
                name=random
                numerical_equals=1
            [/variable]
            [then]
                [kill]
                    id=Erart
                [/kill]
                {GUARD_UNIT (Giant Spider) () ( _ "Fang") 3 5 5}
                [kill]
                    id=Raol
                [/kill]
                {GUARD_UNIT (Giant Spider) () ( _ "Fang") 2 25 5}
            [/then]
        [/if]
        [if]
            [variable]
                name=random
                numerical_equals=2
            [/variable]
            [then]
                [kill]
                    id=Raol
                [/kill]
                {GUARD_UNIT (Giant Spider) () ( _ "Fang") 2 25 5}
                [kill]
                    id=Rilg
                [/kill]
                {GUARD_UNIT (Giant Spider) () ( _ "Fang") 5 5 25}
            [/then]
        [/if]
        [if]
            [variable]
                name=random
                numerical_equals=3
            [/variable]
            [then]
                [kill]
                    id=Rilg
                [/kill]
                {GUARD_UNIT (Giant Spider) () ( _ "Fang") 5 5 25}
                [kill]
                    id=Gulg
                [/kill]
                {GUARD_UNIT (Giant Spider) () ( _ "Fang") 4 25 25}
            [/then]
        [/if]
        [if]
            [variable]
                name=random
                numerical_equals=4
            [/variable]
            [then]
                [kill]
                    id=Gulg
                [/kill]
                {GUARD_UNIT (Giant Spider) () ( _ "Fang") 4 25 25}
                [kill]
                    id=Erart
                [/kill]
                {GUARD_UNIT (Giant Spider) () ( _ "Fang") 3 5 5}
            [/then]
        [/if]

        [recall]
            id=Lady Jessica
            x=14
            y=15
        [/recall]
        [recall]
            id=Burin the Lost
            x=16
            y=14
        [/recall]
        [recall]
            id=Minister Edmond
            x=15
            y=16
        [/recall]

        [objectives]
            side=1
            [objective]
                description= _ "Defeat all enemy leaders"
                condition=win
            [/objective]
            [objective]
                description= _ "Death of Prince Haldric"
                condition=lose
            [/objective]
            [objective]
                description= _ "Death of Lady Jessica"
                condition=lose
            [/objective]
            [objective]
                description= _ "Turns run out"
                condition=lose
            [/objective]
        [/objectives]
    [/event]

    [event]
        name=start
        [message]
            speaker=narrator
            message= _ "It isn't long before Haldric and his companions enter the Brown Hills. An elven guide leads them to a gaping cave mouth, and they descend into the darkness."
            image=wesnoth-icon.png
        [/message]

        [message]
            speaker=Prince Haldric
            message= _ "Does anybody actually know anything about trolls?"
        [/message]

        [message]
            speaker=Burin the Lost
            message= _ "I indeed do. They are green, and mean, and will try to crush you like a bug. They heal very quickly."
        [/message]

        [message]
            speaker=Lady Jessica
            message= _ "Hmm... Do we really need to know that much about the trolls? I think it's safe to say that the elves wouldn't have sent us down here if they were at all friendly."
        [/message]

        [message]
            speaker=Prince Haldric
            message= _ "Fair enough. Well, let's get them!"
        [/message]
    [/event]

    [event]
        name=time over
        [message]
            speaker=Prince Haldric
            message= _ "We have failed... More of the trolls' kin are arriving through the entrance."
        [/message]
    [/event]

    [event]
        name=die
        [filter]
            id=Erart
        [/filter]
        {LOOT 50 1}
    [/event]

    [event]
        name=die
        [filter]
            id=Raol
        [/filter]
        {LOOT 50 1}
    [/event]

    [event]
        name=die
        [filter]
            id=Rilg
        [/filter]
        {LOOT 50 1}
    [/event]

    [event]
        name=die
        [filter]
            id=Gulg
        [/filter]
        {LOOT 50 1}
    [/event]

    [event]
        name=victory
        [message]
            speaker=Prince Haldric
            message= _ "The trolls are beaten, but they were no easy opponents. It is no wonder why the elves pressed us to do their dirty work."
        [/message]

        {VARIABLE_OP num_done add 1}

        [set_variable]
            name=troll_hole
            value=1
        [/set_variable]

        [set_variable]
            name=last_done
            value="Hole"
        [/set_variable]

        {CLEAR_VARIABLE random}
    [/event]
[/scenario]

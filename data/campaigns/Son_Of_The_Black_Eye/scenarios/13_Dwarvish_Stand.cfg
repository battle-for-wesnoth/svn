#textdomain wesnoth-sotbe
[scenario]
    id=Blasted_Elves
    name= _ "The Dwarvish Stand"
    map_data="{campaigns/Son_Of_The_Black_Eye/maps/Dwarvish_Stand.map}"
    {TURNS 35 30 27}

    {DEFAULT_SCHEDULE}

    {SCENARIO_MUSIC "knalgan_theme.ogg"}

    next_scenario=back_home

    [event]
        name=prestart
        [objectives]
            side=1
            [objective]
                description= _ "Defeat all enemy leaders"
                condition=win
            [/objective]
            [objective]
                description= _ "Death of Kapou'e"
                condition=lose
            [/objective]
            [objective]
                description= _ "Death of Grüü"
                condition=lose
            [/objective]
            [objective]
                description= _ "Turns run out"
                condition=lose
            [/objective]

            note= _ "The Great Horde: upkeep cost of every unit decreased by one."
        [/objectives]
    [/event]

    [side]
        type=Orcish Leader
        id="Kapou'e"
        name= _ "Kapou'e"
        side=1
        canrecruit=yes
        controller=human
        recruit= Wolf Rider, Orcish Grunt, Troll Whelp, Orcish Archer
        team_name=Kapoue
        user_team_name=_ "Kapou'e"
        gold=300
        {BLACK_FLAG}
    [/side]

    [side]
        side=2
        no_leader=yes
        recruit= Wolf Rider, Orcish Grunt, Troll Whelp, Orcish Archer, Orcish Crossbowman, Orcish Warrior
        team_name=Kapoue
        user_team_name=_ "Kapou'e"
        {GOLD 200 150 100}
    [/side]

    [side]
        side=3
        no_leader=yes
        recruit= Wolf Rider, Orcish Grunt, Troll Whelp, Orcish Archer, Orcish Crossbowman, Orcish Warrior
        team_name=Kapoue
        user_team_name=_ "Kapou'e"
        {GOLD 200 150 100}
    [/side]

    [side]
        type=Dwarvish Steelclad
        id=Darstang
        name= _ "Darstang"
        side=4
        canrecruit=yes
        recruit=Dwarvish Fighter, Dwarvish Thunderer, Gryphon Rider, Dwarvish Steelclad
        team_name=villains
        user_team_name=_"Villains"
        {GOLD 350 400 450}
    [/side]

    [side]
        type=Bandit
        id=Sam
        name= _ "Sam"
        recruit=Thug,Bandit,Poacher,Trapper,Footpad
        side=5
        canrecruit=yes
        team_name=villains
        user_team_name=_"Villains"
        {GOLD 200 250 300}
    [/side]

    [story]
        [part]
            story= _ "After conquering and occupying Dorset, Kapou'e and his men set themselves to stabilizing the area and bringing it firmly under the iron-hard orcish rule."
            background=sotbe.png
        [/part]

        [part]
            story= _ "After a few weeks of putting down minor rebellions and clearing out the last human strongholds, the first snows of the long Northern winter began to fall. A few days after the first snowfall a goblin rider - half dead from exhaustion - raced into Dorset with the news that Borstep was under siege by a large force of dwarves, outlaws and elves."
            background=sotbe.png
        [/part]

        [part]
            story= _ "The orcish commanders were stunned. How had such a large enemy force penetrated so deep and so far into orcish territory, especially without their knowledge? How also had their enemies known to strike at Borstep, which was the rally point for orcish forces as well as their main arms and supply depot?"
            background=sotbe.png
        [/part]

        [part]
            story= _ "Kapou'e suspected some sort of treachery. Under the assumption that human attacks would be minimal due to the harsh weather, he left only a small force to defend Dorset while he and the main horde of orcs sped to the aid of Borstep."
            background=sotbe.png
        [/part]

        [part]
            story= _ "Rushing to reach Borstep before the river froze up for the winter, the orcs sailed up the river Gork up to where it joined the Bork. Paddling day and night the horde barely managed to get through the Silent Forest before the river froze solid. Beaching their crafts, they marched the last leg of their journey through the deepening snow of the Mourned Hills."
            background=sotbe.png
        [/part]

        [part]
            story= _ "As they crested the last hill before the city, the sight before them cast them into gloom; there was nothing left of Borstep. The walls had been smashed, houses burnt and its inhabitants driven out or slaughtered. Of the orcish shamans there was no sign."
            background=sotbe.png
        [/part]

        [part]
            story= _ "With eyes burning with apprehension and rage, Kapou'e sent his riders out to scour the land in all directions for the culprits while he made camp with the rest of the horde. A few hours later a rider reported back that he had picked up a trail of a large body of dwarves, elves and humans heading east through the mountains."
            background=sotbe.png
        [/part]

        [part]
            story= _ "Breaking camp the following dusk, the horde set out in hot pursuit. By the third day, they caught up with their enemies."
            background=sotbe.png
        [/part]

        [part]
            background=sotbe.png
            show_title=yes
            {DOT 432 444}
            {DOT 423 425}
            {DOT 437 408}
            {DOT 446 387}
            {DOT 417 374}
            {DOT 392 355}
            {DOT 385 317}
            {DOT 367 290}
            {DOT 358 266}
            {DOT 361 239}
            {DOT 385 229}
            {DOT 410 230}
            {CROSS 428 218}
        [/part]
    [/story]

    [event]
        name=prestart

        [recall]
            id="Al'Brock"
            x,y=13,18
        [/recall]

        [recall]
            id="Flar'Tar"
            x,y=2,12
        [/recall]

        [store_unit]
            [filter]
                id="Kapou'e"
            [/filter]
            variable=stored_Kapoue
            kill=yes
        [/store_unit]

        [store_unit]
            [filter]
                id="Al'Brock"
            [/filter]
            variable=stored_AlBrock
            kill=yes
        [/store_unit]

        [store_unit]
            [filter]
                id="Flar'Tar"
            [/filter]
            variable=stored_FlarTar
            kill=yes
        [/store_unit]
    [/event]

    {GOT_THE_GREAT_HORDE 1,2,3}

    [event]
        name=start

        [unit]
            type=Elvish Champion
            id=Thelarion
            name= _ "Thelarion"
            side=4
            x=18
            y=2
        [/unit]

        {RENAME_IF_DEAD thelarion_dead Thelarion (_"Pelondras")}
        {RENAME_IF_DEAD darstang_dead Darstang (_"Trithalsul")}

        [message]
            speaker=Darstang
            message= _ "My my, look at this, two abandoned keeps. Probably built by those orcs in one of their pointless wars against each other."
        [/message]

        [move_unit_fake]
            type=$stored_Kapoue.type
            side=1
            x=1,6
            y=19,16
        [/move_unit_fake]

        [unstore_unit]
            variable=stored_Kapoue
        [/unstore_unit]

        {VARIABLE stored_AlBrock.side 2}
        {VARIABLE stored_AlBrock.canrecruit yes}

        [move_unit_fake]
            type=Orcish Warlord
            side=2
            x=5,13
            y=20,18
        [/move_unit_fake]

        [unstore_unit]
            variable=stored_AlBrock
        [/unstore_unit]

        {VARIABLE stored_FlarTar.side 3}
        {VARIABLE stored_FlarTar.canrecruit yes}

        [move_unit_fake]
            type=Orcish Warlord
            side=3
            x=1,2
            y=16,12
        [/move_unit_fake]

        [unstore_unit]
            variable=stored_FlarTar
        [/unstore_unit]

        {CLEAR_VARIABLE stored_Kapoue,stored_AlBrock,stored_FlarTar}

        [recall]
            id=Grüü
        [/recall]
        [recall]
            id=Jetto
        [/recall]
        [recall]
            id=Inarix
        [/recall]

        [message]
            speaker=Thelarion
            message= _ "Blast it, the orcs have caught up to us."
        [/message]

        [message]
            speaker=Darstang
            message= _ "Elf, our kind can move and fight far better and faster in these conditions then your kind can. Take the orcish prisoners and hurry to Melmog. The dwarves shall stop this orcish menace!"
        [/message]

        [message]
            speaker=Thelarion
            message= _ "Very well, but our human allies will also stay behind and help you. After all, we are dealing with the Son of the Black-Eye here."
        [/message]

        [message]
            speaker=Darstang
            message= _ "Pah, have it your way then. Now, hurry on your way elf."
        [/message]

        [kill]
            id=Thelarion
        [/kill]

        [move_unit_fake]
            type=Elvish Champion
            side=4
            x=19,29
            y=2,1
        [/move_unit_fake]

        [message]
            speaker=Darstang
            message= _ "Pah, cowardly little elves. No dwarf would have ever agreed to such a proposal. Good riddance too, those elves just get in the way. Come on men, it's time to show those orcs our steel!"
        [/message]

        [message]
            speaker=Grüü
            message= _ "Ahhh, nice. I finally get chance to squash dwarves again."
        [/message]

        [message]
            speaker="Kapou'e"
            message= _ "Let's make them pay for what they did to our people. Blood and steel!"
            image=portraits/kapoue-angry.png
        [/message]
    [/event]

    [event]
        name=victory
        [message]
            speaker="Kapou'e"
            message= _ "Victory...Grüü, what *is* that you are eating?"
        [/message]

        [message]
            speaker=Grüü
            message= _ "A human-worm's dog. Animal meat very tasty. When we fight humans again, can I have a pony?"
        [/message]

        [store_unit]
            [filter]
                id="Al'Brock"
            [/filter]

            kill=yes
            variable=stored_AlBrock
        [/store_unit]

        [store_unit]
            [filter]
                id="Flar'Tar"
            [/filter]

            kill=yes
            variable=stored_FlarTar
        [/store_unit]

        {VARIABLE stored_AlBrock.side 1}
        {VARIABLE stored_AlBrock.canrecruit no}

        {VARIABLE stored_FlarTar.side 1}
        {VARIABLE stored_FlarTar.canrecruit no}

        [unstore_unit]
            variable=stored_AlBrock
        [/unstore_unit]

        [unstore_unit]
            variable=stored_FlarTar
        [/unstore_unit]

        #        [store_unit]
        #            [filter]
        #                side=2
        #            [/filter]
        #
        #            kill=no
        #            variable=AlBrock_recalls
        #        [/store_unit]
        #
        #        [store_unit]
        #            [filter]
        #                side=3
        #            [/filter]
        #
        #            kill=no
        #            variable=FlarTar_recalls
        #        [/store_unit]

        {CLEAR_VARIABLE stored_AlBrock,stored_FlarTar}
    [/event]

    {@campaigns/Son_Of_The_Black_Eye/utils/deaths.cfg}
[/scenario]

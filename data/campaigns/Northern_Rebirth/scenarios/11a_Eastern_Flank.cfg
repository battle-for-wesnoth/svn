#textdomain wesnoth-nr
[scenario]
    # Basic scenario data, music, turn limit, default time schedule
    id=eastern_flank
    name= _ "The Eastern Flank"
    {SCENARIO_MUSIC "loyalists.ogg"}
    map_data="{campaigns/Northern_Rebirth/maps/eastern_flank.map}"
    {DEFAULT_SCHEDULE}
    {TURNS4 56 53 50 47}
    next_scenario=get_gold
    # Short story introduction
    [story]
        [part]
            story= _ "After breaking out of their encirclement, the party continued in pursuit of the trolls."
        [/part]
        [part]
            story= _ "Following the bank of a river, they soon entered a valley. At the mouth of the valley there loomed the massive orcish fortress of Angthurim."
        [/part]
    [/story]
    # Players side
    [side]
        type=Lieutenant
        id=Tallin
        name=_ "Tallin"
        canrecruit=yes
        side=1
        controller=human
        recruit=Peasant,Woodsman,Thug,Poacher,Spearman,Bowman,Gryphon,Dwarvish Ulfserker,Footpad
        team_name=knalgans
        user_team_name=_"Alliance"
    [/side]

    {STARTING_VILLAGES 1 6}
    # Opposing AIs, trolls, [ai] keys force it to utilise full recall list
    [side]
        type=Troll Warrior
        name= _ "Gore"
        id=Gore
        canrecruit=yes
        side=2
        {GOLD4 500 600 700 800}
        {INCOME4 25 35 45 55}
        recruit=Troll Whelp,Troll,Troll Rocklobber
        team_name=orcs
        user_team_name=_"Orcs"
        [ai]
            recruitment_ignore_bad_movement=yes
            recruitment_ignore_bad_combat=yes
        [/ai]
    [/side]
    # Orcs
    [side]
        type=Orcish Warlord
        id=Carron
        name= _ "Carron"
        canrecruit=yes
        side=3
        recruit=Orcish Grunt,Orcish Warrior,Orcish Archer,Orcish Crossbowman,Wolf Rider,Orcish Assassin
        {GOLD4 400 500 600 700}
        {INCOME4 25 35 45 55}
        team_name=orcs
        user_team_name=_"Orcs"
    [/side]

    [side]
        type=Orcish Warlord
        id=Rash
        name= _ "Rash"
        canrecruit=yes
        side=4
        recruit=Orcish Grunt,Orcish Warrior,Orcish Archer,Orcish Crossbowman,Wolf Rider,Orcish Assassin
        {GOLD4 400 500 600 700}
        {INCOME4 25 35 45 55}
        team_name=orcs
        user_team_name=_"Orcs"
    [/side]

    [side]
        type=Orcish Warlord
        id="Al'Mar"
        name= _ "Al'Mar"
        canrecruit=yes
        side=5
        recruit=Orcish Grunt,Orcish Warrior,Orcish Archer,Orcish Crossbowman,Wolf Rider,Orcish Assassin
        {GOLD4 400 500 600 700}
        {INCOME4 25 35 45 55}
        team_name=orcs
        user_team_name=_"Orcs"
    [/side]

    [side]
        type=Orcish Warlord
        id="Ha'Tang"
        name= _ "Ha'Tang"
        canrecruit=yes
        side=6
        recruit=Orcish Grunt,Orcish Warrior,Orcish Archer,Orcish Crossbowman,Wolf Rider,Orcish Assassin
        {GOLD4 400 500 600 700}
        {INCOME4 25 35 45 55}
        team_name=orcs
        user_team_name=_"Orcs"
    [/side]
    # Allied side - also player controlled, leader serves as a placeholder for Krash if he's alive
    [side]
        side=7
        {GOLD4 300 250 200 150}
        recruit=Drake Fighter,Drake Glider,Drake Burner,Drake Clasher
        team_name=knalgans
        user_team_name=_"Alliance"
        controller=human
	no_leader=yes
    [/side]
    # Check if Krash is on recall list and if yes replace side 7 leader with him
    [event]
        name=prestart

        [recall]
            id=Krash
        [/recall]
        [if]
            [have_unit]
                id=Krash
            [/have_unit]
            [then]
				[store_unit]
					[filter]
						id=Krash
					[/filter]
					kill=yes
					fire_event=no
					variable=placing_krash
				[/store_unit]
				[store_starting_location]
					side=7
					variable=placing_krash_on
				[/store_starting_location]
				{VARIABLE placing_krash.x $placing_krash_on.x}
				{VARIABLE placing_krash.y $placing_krash_on.y}
				{VARIABLE placing_krash.side 7}
				[unstore_unit]
					variable=placing_krash
				[/unstore_unit]
				{CLEAR_VARIABLE placing_krash}
				{CLEAR_VARIABLE placing_krash_on}
			[/then]
			[else]
                [terrain]
                    x=29,29,30,30,30,31,31,31,32,32
                    y=6,7,5,6,7,6,7,8,6,7
                    terrain=Mm
                [/terrain]
                [gold]
                    side=1
                    amount=200
                [/gold]
            [/else]
        [/if]
    [/event]

    # Recall heroes, place some bad guys, do initial dialogue
    [event]
        name=start

        [role]
            [filter_wml]
                [variables]
                    role=Supporter
                [/variables]
            [/filter_wml]
            role=Supporter
        [/role]

        [recall]
            role=Supporter
        [/recall]
        [recall]
            id=Abhai
        [/recall]
        [recall]
            id=Camerin
        [/recall]
        [recall]
            id=Father Marcus
        [/recall]
        [recall]
            id=Sister Theta
        [/recall]
        [recall]
            id=Elenia
        [/recall]
        [recall]
            id=Anita
        [/recall]
        [recall]
            id=Stalrag
        [/recall]
        [recall]
            id="Ro'Arthian"
        [/recall]
        [recall]
            id="Ro'Sothian"
        [/recall]

        [unit]
            type=Orcish Sovereign
            id=Rakshas
            profile=portraits/Rakshas.jpg
            name= _ "Rakshas"
            x=7
            y=15
            side=2
        [/unit]
        {GENERIC_UNIT 2 "Orcish Warlord" 8 14}
        {GENERIC_UNIT 2 "Orcish Warlord" 6 14}
        {GENERIC_UNIT 1 "Gryphon" 32 9}
        [message]
            speaker=Tallin
            message= _ "Gods of Light! Look at that fortress. The castle Angthurim is even grimmer than its reputation."
        [/message]
        # Hidiel part takes place only if Anita is alive
        [if]
            [have_unit]
                id=Anita
            [/have_unit]
            [then]
                [message]
                    speaker=Anita
                    message= _ "I was not idle in my captivity; I watched, and listened, and learned. The hints I got from my guards' boastings and foul jests have been confirmed by our scouts; Angthurim is the linchpin of their entire eastern flank. If we could reduce it, their defense would be near to collapse."
                [/message]
                [unit]
                    side=1
                    type=Elvish Marshal
                    id=Hidel
                    name= _ "Hidel"
                    profile=portraits/Hidel.jpg
                    x=33
                    y=13
                [/unit]
            [/then]
            [else]
                [message]
                    speaker="Ro'Arthian"
                    message= _ "Fitting. My gryphons tell me Angthurim is the keystone of their entire eastern flank. If we can reduce it their defense will be near to collapse."
                [/message]
            [/else]
        [/if]
        [message]
            role=Supporter
            message= _ "Hey, look who is here!"
        [/message]
        [message]
            speaker=Rakshas
            message= _ "Where is my gold!"
        [/message]
        [message]
            speaker=Tallin
            message= _ "It's Rakshas!"
        [/message]
        [message]
            speaker=Gore
            message= _ "Right here, Master."
        [/message]
        [message]
            speaker=Rakshas
            message= _ "Ahhhhh, very good, my loyal servant. You will be richly rewarded for this! Tell me, what news do you have on that human vermin that has so persistently evaded my clutches?"
        [/message]
        [message]
            speaker=Gore
            message= _ "We trapped him and his pitiful band of followers. By now they will have been mashed to paste and fed to the whelps."
        [/message]
        [message]
            speaker=Rakshas
            message= _ "Hahahaha! Very g..."
        [/message]
        [message]
            speaker=Tallin
            message= _ "RAKSHAS!!!"
        [/message]
        [message]
            speaker=Rakshas
            message= _ "What!? YOU! YOU ANNOYING, DISGUSTING LITTLE VERMIN! DON'T YOU KNOW HOW TO DIE!?"
        [/message]
        [message]
            speaker=Tallin
            message= _ "Foul one, the only one who will be dying here is you and anyone who comes between us. Stand and fight!"
        [/message]
        [message]
            speaker=Rakshas
            message= _ "Pah! I have better things to do then stamp out your insignificant life. Generals, kill him and bring me his head!"
        [/message]
        [kill]
            race=orc
            side=2
            fire_event=no
        [/kill]
        [move_unit_fake]
            type=Orcish Sovereign
            side=2
            x=7,7,7,7,7,7,8,8,8,7,7,8,9,9,9.9,10,10
            y=16,17,18,19,20,21,21,22,23,24,25,25,26,27,28.29,29,30
        [/move_unit_fake]
        [move_unit_fake]
            type=Orcish Warlord
            side=2
            x=7,7,7,7,7,7,8,8,8,7,7,8,9,9,9.9,10,10
            y=16,17,18,19,20,21,21,22,23,24,25,25,26,27,28.29,29,30
        [/move_unit_fake]
        [move_unit_fake]
            type=Orcish Warlord
            side=2
            x=7,7,7,7,7,7,8,8,8,7,7,8,9,9,9.9,10,10
            y=16,17,18,19,20,21,21,22,23,24,25,25,26,27,28.29,29,30
        [/move_unit_fake]
        [if]
            [have_unit]
                id=Anita
            [/have_unit]
            [then]
                [message]
                    speaker=Tallin
                    message= _ "Blast it. The coward has fled. Anita, your elves are good at moving quickly through the forests. Do you think they can overtake and pin him down while we deal with this fortress?"
                [/message]
                [message]
                    speaker=Anita
                    message= _ "Hidel?"
                [/message]
                [message]
                    speaker=Hidel
                    message= _ "Easily, princess. We shall move unseen through the trees, overtake him, and put an end to his flight."
                [/message]
                [message]
                    speaker=Anita
                    message= _ "Then do it. I shall stay with Tallin and... um... because he could use my assistance."
                [/message]
                [message]
                    speaker=Tallin
                    message= _ " *blushes slightly*"
                [/message]
                [message]
                    speaker=Sister Theta
                    message= _ " *wink wink*"
                [/message]
                [message]
                    speaker=Hidel
                    message= _ " *raises eyebrow* Very well, princess."
                [/message]
                [kill]
                    id=Hidel
                [/kill]
                [move_unit_fake]
                    type=Elvish Marshal
                    side=1
                    x=32,31,30,29,28,27,26,26,26,26,26,26,25,24,23,23,23,23,23,23,23,23,23
                    y=13,14,14,14,14,15,15,16,17,18,19,20,21,21,22,23,24,25,26,27,28,29,30
                [/move_unit_fake]
                [move_unit_fake]
                    type=Elvish Scout
                    side=1
                    x=32,31,30,29,28,27,26,26,26,26,26,26,25,24,23,23,23,23,23,23,23,23,23
                    y=13,14,14,14,14,15,15,16,17,18,19,20,21,21,22,23,24,25,26,27,28,29,30
                [/move_unit_fake]
                [move_unit_fake]
                    type=Elvish Avenger
                    side=1
                    x=32,31,30,29,28,27,26,26,26,26,26,26,25,24,23,23,23,23,23,23,23,23,23
                    y=13,14,14,14,14,15,15,16,17,18,19,20,21,21,22,23,24,25,26,27,28,29,30
                [/move_unit_fake]
            [/then]
            [else]
                [message]
                    speaker=Tallin
                    message= _ "Blast it. The coward has fled. Quickly men, we must storm this fortress before he can spend that gold."
                [/message]
                [message]
                    speaker=Stalrag
                    message= _ "Aye! Down wi' the orcs!"
                [/message]
            [/else]
        [/if]

        [message]
            speaker=Tallin
            message= _ "Ro'Arthian, send a message to Hamel. Tell him it's time."
        [/message]
        [kill]
            type=Gryphon
        [/kill]
        [move_unit_fake]
            type=Gryphon
            side=1
            x=31,31,31,31,31,31,31,31,31
            y=9,8,7,6,5,4,3,2,1
        [/move_unit_fake]
        [message]
            speaker="Ro'Arthian"
            message= _ "It's done."
        [/message]
        [message]
            speaker=Tallin
            message= _ "Very well. Forward! Victory or death!"
        [/message]
        [message]
            speaker=Krash
            message= _ "Come on boys, let's give it to 'em!"
        [/message]
        [objectives]
            side=1
            [objective]
                description= _ "Defeat the enemy leaders"
                condition=win
            [/objective]
            [objective]
                description= _ "Death of Tallin"
                condition=lose
            [/objective]
            [objective]
                description= _ "Death of Ro'Arthian"
                condition=lose
            [/objective]
            [objective]
                description= _ "Death of Ro'Sothian"
                condition=lose
            [/objective]
            [objective]
                description= _ "Turns run out"
                condition=lose
            [/objective]
        [/objectives]
        [objectives]
            side=7
            [objective]
                description= _ "Defeat the enemy leaders"
                condition=win
            [/objective]
            [objective]
                description= _ "Death of Tallin"
                condition=lose
            [/objective]
            [objective]
                description= _ "Death of Ro'Arthian"
                condition=lose
            [/objective]
            [objective]
                description= _ "Death of Ro'Sothian"
                condition=lose
            [/objective]
        [/objectives]
    [/event]

    # Flavour event
    [event]
        name=turn 2

        [message]
            speaker=Gore
            message= _ "Move, you stupid orcs! I am trying to recruit here!"
        [/message]
        [message]
            speaker=Rash
            message= _ "Suit yourself, you dumb troll!"
        [/message]
        [message]
            speaker=Sister Theta
            message= _ "Awww, aren't they the most loving, sharing bunch of orcs you have ever seen?"
        [/message]
        [message]
            speaker=Anita
            message= _ " *snicker*"
        [/message]
    [/event]

    # Victory event, choose next scenario depending on wheter Anita is alive or not.
    [event]
        name=victory

        [if]
            [have_unit]
                id=Anita
            [/have_unit]
            [then]
                [message]
                    speaker=Tallin
                    message= _ "We have torn the heart from their eastern defenses. Now let us make haste to rescue Hidel. I am uneasy for him; some of those bodyguards Rakshas keeps are fell fighters."
                [/message]
            [/then]
            [else]
                [message]
                    speaker=Tallin
                    message= _ "We have torn the heart from their eastern defenses. Now to settle scores with Rakshas once and for all!"
                [/message]
                next_scenario=showdown
            [/else]
        [/if]
		[store_unit]
			[filter]
				id=Krash
			[/filter]
			kill=no
			variable=krash_hack
		[/store_unit]
		{VARIABLE krash_hack.side 1}
		[unstore_unit]
			variable=krash_hack
		[/unstore_unit]
		{CLEAR_VARIABLE krash_hack}
    [/event]
    # Load death events
    {campaigns/Northern_Rebirth/utils/herodeaths.cfg}
[/scenario]

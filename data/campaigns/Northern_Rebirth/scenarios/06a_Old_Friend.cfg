#textdomain wesnoth-nr

#define BODYGUARD X Y
    [unit]
        type=Orcish Warlord
        x={X}
        y={Y}
        side=2
        ai_special=guardian
    [/unit]
#enddef

#define KNIGHT X Y
    [unit]
        type=Goblin Knight
        x={X}
        y={Y}
        side=2
    [/unit]
#enddef

[scenario]
    id=old_friend
    name= _ "Old Friend"
    next_scenario=settling_disputes
    {SCENARIO_MUSIC "breaking_the_chains.ogg"}

    [story]
        [part]
            story= _ "Laden with gold, and filled with an elation at their victory that was tempered with sadness at the death of their friends, Tallin and his people made their way back to the mines."
        [/part]

        [part]
            story= _ "As they approached they were met with a most welcome sight: New fortifications, looking very much like the legendary impenetrable dwarvish defenses of old, had sprung up everywhere. All of them were manned by alert and well-armed dwarves who hailed them boisterously. The mines were belching smoke from the furiously working forges. New weapons and armor for humans and dwarves alike lay neatly stacked, and the deafening clang of hammers and picks from the dwarves promised more."
        [/part]

        [part]
            story= _ "They found Hamel in a forge hammering away at a new axe. He greeted them warmly and arrangements were quickly made for all their food and accommodations, as wall as care for the sick and wounded."
        [/part]

        [part]
            story= _ "When Tallin's party had shaken the dust of the road from their clothes, the humans and dwarves once again met in council."
        [/part]

        [part]
            story= _ "It is well, Hamel. You our people prosper."
            background=portraits/Tallin.jpg
        [/part]

        [part]
            story= _ "Aye. Word ha' spread, and dwarves who had been living rough in the wilds for fear of the orcs have been coming to join us. Thanks to you, Tallin, Knalga is rising again!"
            background=portraits/Hamel.jpg
        [/part]

        [part]
            story= _ "We have cleared the connecting tunnels to here and to the old keep as well as other parts o' Knalga."
            background=portraits/Hamel.jpg
        [/part]

        [part]
            story= _ "It is slow and dangerous work, mostly due to the trolls. But it ha' been made easier by Malifor's ending."
            background=portraits/Hamel.jpg
        [/part]

        [part]
            story= _ "The lich's skeletons were fighting the trolls, but when you destroyed him, they all just fell apart. So, there are many tunnels that are now infested with nothing but piles of old bones."
            background=portraits/Hamel.jpg
        [/part]

        [part]
            story= _ "Great! How about the weapons and armor?"
            background=portraits/Tallin.jpg
        [/part]

        [part]
            story= _ "As you can see, Tallin, there are muckle heaps of them, all ready to be borne into battle."
            background=portraits/Hamel.jpg
        [/part]

        [part]
            story= _ "What's more, some of the dwarves who are expert with the sword, mace and bow, as well as some of yer own men who have grown skilled by experience, can teach others how to wield them."
            background=portraits/Hamel.jpg
        [/part]

        [part]
            story= _ "I didn't know that you dwarves knew swordplay. I thought you all fought with axes, hammers or those thunder weapons."
            background=portraits/Tallin.jpg
        [/part]

        [part]
            story= _ "Aye, it's true we do prefer our axes and hammers, but then again, we make swords. We couldna' claim to be expert weaponsmiths wi'out kenning how to wield the weapons we make."
            background=portraits/Hamel.jpg
        [/part]

        [part]
            story= _ "There are some dwarves out there that are bonny fighters wi' a sword as any ye are like to meet. Belike with bows, maces and any other weapons we fashion."
            background=portraits/Hamel.jpg
        [/part]

        [part]
            story= _ "That's great! What is the price of your weapons? We have gathered much booty from Malifor's treasury and we will be able to pay you generously."
            background=portraits/Tallin.jpg
        [/part]

        [part]
            story= _ "Price?!? Don't insult us, Tallin. Ye have done great things to help the dwarves - it's because of you that we ha' made a start rebuilding Knalga in the first place. Dinna ye speak of price to us."
            background=portraits/Hamel.jpg
        [/part]

        [part]
            story= _ "But don't you need the gold to help rebuild Knalga? And we have plenty."
            background=portraits/Tallin.jpg
        [/part]

        [part]
            story= _ "Tallin, Knalga was an extremely rich nation. Malifor's treasury is hardly a fraction of the riches that we will find, and are finding every day now. So nae! Ye'll need yon gold to rebuild Dwarven Doors."
            background=portraits/Hamel.jpg
        [/part]

        [part]
            story= _ "Thank you, Hamel."
            background=portraits/Tallin.jpg
        [/part]

        [part]
            story= _ "Pahhh, thank YOU!"
            background=portraits/Hamel.jpg
        [/part]

        [part]
            story= _ "And Tallin, one more thing, I have been leading our people into battle for many years now. As a young dwarf I was trained in the arts of leadership and war. There are things you will need to know..."
            background=portraits/Hamel.jpg
        [/part]

        [part]
            story= _ "I know you're impressive wi' a pitchfork, and you are not half bad with a sword when you choose to use one. But there skills beyond swingin' a weapon that a general must learn."
            background=portraits/Hamel.jpg
        [/part]

        [part]
            story= _ "I would be honored, Lord Hamel."
            background=portraits/Tallin.jpg
        [/part]

        [part]
            story= _ "Ahhhh, quit with the formality, me lad. Now, first things first. One of the most important things about being a leader is...."
            background=portraits/Hamel.jpg
        [/part]

        [part]
            story= _ "The humans rested for many days while they were equipped with new arms and armor and trained by the dwarves."
        [/part]

        [part]
            story= _ "But the peace was not to last. Early one morning Tallin (sore from head to foot from his training) was startled awake by the blare of trumpets, the pounding of drums and the clash of steel as the humans and dwarves hurried to arm themselves."
        [/part]

        [part]
            story= _ "He sought out Hamel, who informed him that a massive host of orcs had arrived at the gates of the new Knalga."
        [/part]

        [part]
            story= _ "It was decided that Tallin's men sould sally forth to meet the orcs, while Hamel's held open their retreat into the caves."
        [/part]
    [/story]

    turns=18
    {DUSK}
    {FIRST_WATCH}
    {SECOND_WATCH}
    {DAWN}
    {MORNING}
    {AFTERNOON}

    {campaigns/Northern_Rebirth/utils/herodeaths.cfg}
    {STARTING_VILLAGES 1 4}

    map_data="{campaigns/Northern_Rebirth/maps/old_friend.map}"

    [side]
        type=Peasant
        description=Tallin
        user_description=_ "Tallin"
        canrecruit=1
        side=1
        controller=human
        {GOLD4 450 350 300 250}
        recruit=Peasant,Woodsman,Thug,Poacher,Spearman,Bowman,Footpad
        team_name=mob
    [/side]

    [side]
        type=Orcish Sovereign
        description=Rakshas
        profile=portraits/Rakshas.jpg
        user_description= _ "Rakshas"
        canrecruit=1
        side=2
        recruit=Orcish Grunt,Orcish Archer,Wolf Rider,Orcish Assassin,Troll Whelp,Orcish Warrior,Orcish Crossbowman,Troll
        {GOLD4 400 500 600 700}
        {INCOME4 30 40 50 60}
        team_name=orcs
        [ai]
            aggression=1.0
            caution=-1.0
            leader_value=50
        [/ai]
    [/side]

    [side]
        type=Orcish Warlord
        description=Drung
        user_description= _ "Drung"
        canrecruit=1
        side=3
        recruit=Orcish Grunt,Orcish Archer,Wolf Rider,Orcish Assassin,Troll Whelp,Orcish Warrior,Orcish Crossbowman,Troll
        {GOLD4 400 500 600 700}
        {INCOME4 30 40 50 60}
        team_name=orcs
        [ai]
            aggression=1.0
            caution=-1.0
            leader_value=50
        [/ai]
    [/side]

    [side]
        type=Orcish Warlord
        description=Poul
        user_description= _ "Poul"
        canrecruit=1
        side=4
        recruit=Orcish Grunt,Orcish Archer,Wolf Rider,Orcish Assassin,Troll Whelp,Orcish Warrior,Orcish Crossbowman,Troll
        {GOLD4 400 500 600 700}
        {INCOME4 30 40 50 60}
        team_name=orcs
        [ai]
            aggression=1.0
            caution=-1.0
            leader_value=50
        [/ai]
    [/side]

    [event]
        name=prestart

        # {SCATTER_IMAGE (terrain=Gg,Gs^Fp) 12 scenery/pine2.png}

        [set_variable]
            name=keep
            value=1
        [/set_variable]
        [set_variable]
            name=keep.x
            value=26
        [/set_variable]
        [set_variable]
            name=keep.y
            value=3
        [/set_variable]
        [set_variable]
            name=sallied
            value=1
        [/set_variable]

        [store_unit]
            [filter]
                description=Tallin
            [/filter]
            variable=typechange
            kill=yes
        [/store_unit]

	# Rewrite the if statements to slightly more compact and elegant form
        [if]
            [variable]
                name=typechange.level
                greater_than=2
            [/variable]
            [then]
				{VARIABLE typechange.type General}
            [/then]
			[else]
				[if]
					[variable]
						name=typechange.level
						greater_than=1
					[/variable]
					[then]
						{VARIABLE typechange.type Lieutenant}
					[/then]
					[else]
						{VARIABLE typechange.type Sergeant}
					[/else]
				[/if]
			[/else]
        [/if]

        [unstore_unit]
            variable=typechange
            find_vacant=yes
        [/unstore_unit]
        {CLEAR_VARIABLE typechange}
    [/event]

    [event]
        name=start
	# Remove reaplying of object, if they are permanent they get stored and unstored with the unit
        {CLEAR_VARIABLE tallin_gotta_stick}

        [role]
            type=Halberdier, Royal Guard, Master Bowman, Pikeman, Swordsman, Longbowman, Javelineer, Spearman, Bowman, Peasant
            role=Supporter
        [/role]
        [recall]
            role=Supporter
        [/recall]

        {BODYGUARD 2 20}
        {BODYGUARD 5 20}
        {BODYGUARD 7 21}
        {BODYGUARD 9 22}
        {BODYGUARD 9 24}
        {BODYGUARD 9 26}
        {BODYGUARD 8 27}

        [recall]
            description=Camerin
        [/recall]

        [recall]
            description=Abhai
        [/recall]

        [recall]
            description=Krash
        [/recall]

        [recall]
            description=Elenia
        [/recall]

        [recall]
            description=Father Marcus
        [/recall]

        [recall]
            description=Sister Theta
        [/recall]

        [message]
            description=Rakshas
            message= _ "So I see you fat pigs finally mustered up the courage to face me."
        [/message]

        [message]
            description=Tallin
            message= _ "Who are you, what do you want?"
        [/message]

        [message]
            description=Rakshas
            message= _ "I am Emperor Rakshas and by the power of my sword, I lead the orcish people. I am here simply finishing the job Khazg Black-Tusk started years ago - the conquest of Knalga."
        [/message]

        [message]
            description=Tallin
            message= _ "Khazg tried and failed, and if you repeat his folly you will soon join him in the land of the dead!"
        [/message]

        [message]
            description=Rakshas
            message= _ "Pah! I would like to see those cowardly dwarves try their treachery on me as they did on the Black-Tusk! In any case, those dwarves will soon be groveling at my feet and equipping my people with the finest weapons. With the dwarvish weapons, and the wealth of Knalga, nothing will be able to stop us. Even that little backwater that you humans call Wesnoth will be nothing but a burnt out, pillaged wreck before long."
        [/message]

        [message]
            description=Tallin
            message= _ "Boy, this guy sure has delusions of grandeur."
        [/message]

        [message]
            role=Supporter
            message= _ "I am not so sure it's that simple Tallin. Think back to those orcs back in dwarven doors, and those wolves on the way to the mines; they were both saying something about 'The Master'."
        [/message]

        [message]
            description=Tallin
            message= _ "Yeah?"
        [/message]

        [message]
            role=Supporter
            message= _ "Well, unless I miss my guess, dreamy fellow would be him."
        [/message]

        [message]
            description=Tallin
            message= _ "Well, if that is so, then it's time to end this menace once and for all! Fall on them boys!"
        [/message]

        [objectives]
            side=1
            [objective]
                description= _ "Defeat Rakshas... if you can..."
                condition=win
            [/objective]
            [objective]
                description= _ "Or, resist till end of turns"
                condition=win
            [/objective]
            [objective]
                description= _ "Death of Tallin"
                condition=lose
            [/objective]
        [/objectives]
    [/event]

    [event]
        name=die
        [filter]
            description=Rakshas
        [/filter]

        [message]
            description=Rakshas
            message= _ "Ahhhh! Run for your life!"
        [/message]

        [message]
            speaker=second_unit
            message= _ "What the... Hey, where do you think you are running off to you coward!"
        [/message]

        [message]
            description=Tallin
            message= _ "Stop him!"
        [/message]

        [message]
            speaker=second_unit
            message= _ "It's too late, I am sorry, Tallin, he got away! We did not expect he would flee like a coward."
        [/message]

        [message]
            description=Tallin
            message= _ "Damn! We had the opportunity to end the war in one stroke there. Now we will have to go after him, assuming we can break this siege!"
        [/message]
    [/event]

    [event]
        name=time over
        [message]
            description=Tallin
            message= _ "Geez, we have been fighting them for three whole days and nights now with no end in sight. Now the forth night is approaching, what should we do?"
        [/message]

        [message]
            description=Father Marcus
            message= _ "It seems hopeless to continue on like this. The orcs numbers are unlimited and Rakshas is very well guarded. The only possible outcome to all this is more slaughter."
        [/message]

        [message]
            description=Sister Theta
            message= _ "I propose that we retreat back into the caves and consult with the dwarves."
        [/message]

        {SUPPORTER}

        [message]
            role=Supporter
            message= _ "I agree, Tallin, it is pointless to carry on."
        [/message]

        [message]
            description=Tallin
            message= _ "Very well. Everyone fall back!"
        [/message]

        [message]
            description=Camerin
            message= _ "Awwwww! Just when I was having the most fun!"
        [/message]

        [endlevel]
            result=victory
            bonus=no
        [/endlevel]
    [/event]

    [event]
        name=moveto
        [filter]
            side=1
            x=1-9
            y=10-27
        [/filter]

        [message]
            description=Rakshas
            message= _ "So your forces are managing to advance upon me are they? Very impressive but it shall do you no good. KNIGHTS!!!"
        [/message]

        {KNIGHT 15 17}
        {KNIGHT 15 17}
        {KNIGHT 15 17}
        {KNIGHT 15 17}
        {KNIGHT 15 17}
        {KNIGHT 15 17}
        {KNIGHT 15 17}
        {KNIGHT 15 17}
        {KNIGHT 15 17}
        {KNIGHT 15 17}
        {KNIGHT 15 17}
        {KNIGHT 15 17}

        {KNIGHT 11 16}
        {KNIGHT 11 16}
        {KNIGHT 11 16}
        {KNIGHT 11 16}
        {KNIGHT 11 16}
        {KNIGHT 11 16}
        {KNIGHT 11 16}

        {KNIGHT 7 16}
        {KNIGHT 7 16}
        {KNIGHT 7 16}
        {KNIGHT 7 16}
        {KNIGHT 7 16}
        {KNIGHT 7 16}
        {KNIGHT 7 16}
        {KNIGHT 7 16}
        {KNIGHT 7 16}
        {KNIGHT 7 16}

        {KNIGHT 26 22}
        {KNIGHT 26 22}
        {KNIGHT 26 22}
        {KNIGHT 26 22}
        {KNIGHT 26 22}
        {KNIGHT 26 22}

        {KNIGHT 25 26}
        {KNIGHT 25 26}
        {KNIGHT 25 26}
        {KNIGHT 25 26}
        {KNIGHT 25 26}
        {KNIGHT 25 26}

        [unit]
            type=Goblin Knight
            description=Goblin Knight
            side=2
            x=15
            y=17
        [/unit]

        [message]
            description=Goblin Knight
            message= _ "HAHAHAHAHA, GOT YOU, SUCKERS!"
        [/message]

        [message]
            description=Rakshas
            message= _ "CHARGE!!!"
        [/message]

        [message]
            description=Tallin
            message= _ "Oh, hell! Form up men, back to back, don't let them penetrate our ranks."
        [/message]

        [message]
            description=Rakshas
            message= _ "That's not all, my friends. GENERALS, CALL THE RESERVES!"
        [/message]

        [message]
            description=Drung
            message= _ "Oh yeah!"
        [/message]

        [message]
            description=Poul
            message= _ "HAHAHAHAHA!"
        [/message]

        [message]
            description=Drung
            message= _ "You are so dead, you human vermin!"
        [/message]

        [message]
            description=Poul
            message= _ "Oooooooh! Time to start the fun!"
        [/message]

        [gold]
            side=2
            amount=2000
        [/gold]

        [gold]
            side=3
            amount=2000
        [/gold]

        [gold]
            side=4
            amount=2000
        [/gold]

        [gold]
            side=5
            amount=2000
        [/gold]

        [message]
            role=Supporter

            message= _ "This doesn't look good..."
        [/message]
    [/event]

    [event]
        name=die
        [filter]
            description=Drung
        [/filter]

        [message]
            description=Drung
            message= _ "Argh! I have been slain!"
        [/message]

        [message]
            speaker=second_unit
            message= _ "Killed him! Got his gold too. Lets see, hmmmmm, about 500 gold pieces. Not bad."
        [/message]

        [gold]
            side=1
            amount=512
        [/gold]

        [message]
            description=Rakshas
            message= _ "They have killed one of my generals! REINFORCEMENTS!"
        [/message]

        [gold]
            side=2
            amount=500
        [/gold]

        [gold]
            side=3
            amount=500
        [/gold]

        [gold]
            side=4
            amount=500
        [/gold]

        [gold]
            side=5
            amount=500
        [/gold]

        [gold]
            side=6
            amount=500
        [/gold]
    [/event]

    [event]
        name=die
        [filter]
            description=Poul
        [/filter]

        [message]
            description=Poul
            message= _ "My death will only make the Master's punishment for you worse you fools!"
        [/message]

        [message]
            speaker=second_unit
            message= _ "Your death makes your Master's punishment from us one step closer!"
        [/message]

        [message]
            speaker=second_unit
            message= _ "But my my, what's in that big pouch? 300 gold! Not bad."
        [/message]

        [gold]
            side=1
            amount=302
        [/gold]

        [message]
            description=Rakshas
            message= _ "You vermin will pay for that! REINFORCEMENTS!"
        [/message]

        [gold]
            side=2
            amount=500
        [/gold]

        [gold]
            side=3
            amount=500
        [/gold]

        [gold]
            side=4
            amount=500
        [/gold]

        [gold]
            side=5
            amount=500
        [/gold]

        [gold]
            side=6
            amount=500
        [/gold]
    [/event]

    [event]
        name=victory

        {CLEAR_VARIABLE keep}
        {CLEAR_VARIABLE sallied}
    [/event]

    [event]
        name=moveto

        [filter]
            x=16,20,18,22,24,17
            y=5,5,7,8,8,12
        [/filter]

        {CLEAR_VARIABLE sallied}
    [/event]

    [event]
        name=turn 3

        [if]
            [variable]
                name=sallied
                numerical_equals=1
            [/variable]

            [then]
                [message]
                    description=Tallin
                    message= _ "Come on, why are we just sitting here in these caves! Have you forgotten already all these orcs have done to us! Let us muddy the ground with their foul blood!"
                [/message]
            [/then]
        [/if]
    [/event]
[/scenario]

#textdomain wesnoth-l

#define USE_L3_OUTLAWS
#enddef

#define SET_VILLAGE X Y SIDE
    [capture_village]
        x={X}
        y={Y}
        side={SIDE}
    [/capture_village]
#enddef

#define LOYAL_PEASANT TYPE X Y DESCRIPTION USER_DESCRIPTION SECOND_TRAIT
	[unit]
        type={TYPE}
        description={DESCRIPTION}
        user_description={USER_DESCRIPTION}
        x,y={X},{Y}
        side=1
        [modifications]
            {TRAIT_LOYAL}
            {SECOND_TRAIT}
        [/modifications]
    [/unit]
#enddef

#
# Two macros to make units, 1 loyal, 1 a guardian
#

#define MK_GUARD X Y SIDE UTYPE NAME
    [unit]
        type={UTYPE}
        description={NAME}
        side={SIDE}
        x={X}
        y={Y}
        ai_special=guardian
    [/unit]
#enddef

#define MK_LOYAL_UNIT X Y SIDE UTYPE NAME
    [unit]
        type={UTYPE}
        description={NAME}
        x={X}
        y={Y}
        side={SIDE}
        [modifications]
            {TRAIT_LOYAL}
        [/modifications]
    [/unit]
#enddef

#
# This one changes a unit from one type to another
#

#define CHG_TYPE UNIT_SIDE TYPEFROM TYPETO
    [store_unit]
        variable=chgtype_store
        kill=no
        [filter]
            side={UNIT_SIDE}
            type={TYPEFROM}
        [/filter]
    [/store_unit]
    [set_variable]
        name=i
        value=0
    [/set_variable]
    [while]
        [variable]
            name=i
            less_than=$chgtype_store.length
        [/variable]
        [do]
            [set_variable]
                name=chgtype_store[$i].type
                value={TYPETO}
            [/set_variable]
            [unstore_unit]
                variable=chgtype_store[$i]
            [/unstore_unit]
            [set_variable]
                name=i
                add=1
            [/set_variable]
        [/do]
    [/while]

    {CLEAR_VARIABLE chgtype_store}
#enddef

#define CHG_TERRAIN LETTER X Y
    [terrain]
        letter={LETTER}
        x={X}
        y={Y}
    [/terrain]
#enddef

#define OBJ_HOLY_ANKH X Y ID
    [event]
        name=moveto
        first_time_only=no
        [filter]
            x={X}
            y={Y}
        [/filter]
        [object]
            id={ID}
            name= _ "Holy Ankh"
            image=props/ankh.png
            duration=level
            description= _ "You find a hefty pendant among the bones.  It glows brightly when you pick it up!"
            cannot_use_message= _ "There are some bones here.  There appears to be something among them."
            [filter]
                side=1
                x,y={X},{Y}
            [/filter]
            [then]
                [removeitem]
                    x,y={X},{Y}
                [/removeitem]
            [/then]
            [effect]
                apply_to=new_attack
                name= _ "holy ankh"
                icon=attacks/lightbeam.png
                type=arcane
                range=ranged
                special=magical
                damage=24
                number=1
                # need a better attack sound, but this will do for now
                [sound]
                    time=-1600
                    sound=aaah.ogg
                [/sound]
                [missile_frame]
                    begin=-180
                    end=0
                    image="projectiles/whitemissile-n.png"
                    image_diagonal="projectiles/whitemissile-ne.png"
                    halo=halo/white-mage-halo1.png,halo/white-mage-halo2.png,halo/white-mage-halo3.png,halo/white-mage-halo4.png
                [/missile_frame]
            [/effect]
        [/object]
    [/event]
#enddef

#define DOT_TIME X Y TIME
    [image]
        x,y={X},{Y}
        file=misc/dot.png
        delay={TIME}
    [/image]
#enddef

#define CROSS_TIME X Y TIME
    [image]
        x,y={X},{Y}
        file=misc/cross.png
        delay={TIME}
    [/image]
#enddef

#define LIBERTY_DEATHS
    [event]
        name=die
        [filter]
            description=Baldras
        [/filter]
        [message]
            description=Baldras
            image=portraits/p_baldras.png
            message= _ "Tell my wife... that I loved her!"
        [/message]
        [endlevel]
            result=defeat
        [/endlevel]
    [/event]

    [event]
        name=die
        [filter]
            description=Harper
        [/filter]
        [message]
            description=Harper
            image=portraits/p_harper.png
            message= _ "Unngh... Now our people may never be free..."
        [/message]
        [endlevel]
            result=defeat
        [/endlevel]
    [/event]

    [event]
        name=die
        [filter]
            description=Relnan
        [/filter]
        [message]
            description=Relnan
            image=portraits/p_relnan.png
            message= _ "I am finished... will we ever be free?"
        [/message]
        [endlevel]
            result=defeat
        [/endlevel]
    [/event]

    [event]
        name=die
        [filter]
            description=Lord Maddock
        [/filter]
        [message]
            description=Lord Maddock
            image=portraits/p_maddock.png
            message= _ "How can this be?  We have lost."
        [/message]
        [endlevel]
            result=defeat
        [/endlevel]
    [/event]
#enddef

#textdomain wesnoth-sof
[unit]
    id=Dwarvish Miner
    name= _ "Dwarvish Miner"
    race=dwarf
    image=units/dwarves/miner.png
    hitpoints=25
    movement_type=dwarvishfoot
    movement=5
    level=1
    alignment=neutral
    advanceto=null
    {AMLA_DEFAULT}
    experience=150
    cost=19
    usage=fighter
    unit_description= _ "Dwarvish miners are the grunt workers of Dwarvish society. They take the precious ores out of the ground, but do not ever take part in the crafting of weapons or artifacts."
    {DEFENSE_ANIM "units/dwarves/miner.png" "units/dwarves/miner.png" {SOUND_LIST:DWARF_HIT} }
    die_sound={SOUND_LIST:DWARF_DIE}
    [attack]
        name=pick
        description= _"pick"
        type=pierce
        range=melee
        damage=4
        number=2
        icon=attacks/pick-axe.png
    [/attack]
    [attack_anim]
        [attack_filter]
            name=pick
        [/attack_filter]
        [frame]
            begin=-200
            end=-100
            image=units/dwarves/miner-attack.png
        [/frame]
        [if]
            hits=yes
            [frame]
                begin=-100
                end=100
                image=units/dwarves/miner-attack2.png
                sound=axe.ogg
            [/frame]
        [/if]
        [else]
            hits=no
            [frame]
                begin=-100
                end=100
                image=units/dwarves/miner-attack2.png
                sound={SOUND_LIST:MISS}
            [/frame]
        [/else]
        [frame]
            begin=100
            end=175
            image=units/dwarves/miner.png
        [/frame]
    [/attack_anim]
[/unit]

#define DWARVEN_MINERS_LOAD_UP FILTER
    # Load up all Dwarvish Miners satisfying FILTER; changes unit images.
    # This is the body of MODIFY_UNIT with some arguments bound.
    [store_unit]
        [filter]
            type=Dwarvish Miner
            {FILTER}
        [/filter]

        variable=MODIFY_UNIT_store
        kill=yes
    [/store_unit]

    {FOREACH MODIFY_UNIT_store MODIFY_UNIT_i}
    [set_variable]
        name=MODIFY_UNIT_store[$MODIFY_UNIT_i].image
        value=units/dwarves/miner-withstuff.png
    [/set_variable]

    [unstore_unit]
        variable=MODIFY_UNIT_store[$MODIFY_UNIT_i]
        find_vacant=no
    [/unstore_unit]
    {NEXT MODIFY_UNIT_i}

    {CLEAR_VARIABLE MODIFY_UNIT_store}
#enddef

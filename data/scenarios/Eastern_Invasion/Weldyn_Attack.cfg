[scenario]
	id=Weldyn_Attack
	textdomain=wesnoth-ei
	name= _ "Weldyn under Attack"
	map_data="{maps/Eastern_Invasion/Weldyn_under_Attack}"
	turns=18


    {DUSK}
    {DUSK}
    {DUSK}
    {FIRST_WATCH}
    {FIRST_WATCH}
    {FIRST_WATCH}
    {FIRST_WATCH}
    {FIRST_WATCH}
    {FIRST_WATCH}
    {SECOND_WATCH}
    {SECOND_WATCH}
    {SECOND_WATCH}
    {SECOND_WATCH}
    {SECOND_WATCH}
    {SECOND_WATCH}
    {DAWN}
    {DAWN}
    {DAWN}
    
	next_scenario=null

	music=frantic.ogg

	objectives= _ "
Victory:
@Survive the night
Defeat:
#Death of Gweddry
#Death of Dacyn
#Death of Owaec
#Death of Konrad"

	{scenarios/Eastern_Invasion/deaths.cfg}

	[story]
		[part]
			background=maps/eastern_invasion.png
			show_title=yes
			{CROSS 100 240}
		[/part]
	[/story]

	[side]
	type=Lieutenant
	description=Gweddry
	side=1
	canrecruit=1
	controller=human
	team_name=good
	[/side]

	[side]
	type=General
	description=Halrad
	side=2
	canrecruit=1
	recruit=Heavy Infantryman,Swordsman,Mage
	controller=ai
	{GOLD 200 150 100}
	team_name=good
		[ai]
		{NO_SCOUTS}
		[/ai]
	[/side]
	[side]
	type=General
	description=Halric
	side=3
	canrecruit=1
	recruit=Heavy Infantryman,Swordsman,Red Mage
	controller=ai
	{GOLD 250 200 150}
	team_name=good
		[ai]
		{NO_SCOUTS}
		[/ai]
	[/side]
	[side]
	type=General
	description=Halrod
	side=4
	canrecruit=1
	recruit=Shock Trooper,Swordsman,Mage
	controller=ai
	{GOLD 250 200 150}
	team_name=good
		[ai]
		{NO_SCOUTS}
		[/ai]
	[/side]
	
	[side]
	type=Lich
	description=Mal-Grekulak
	side=5
	canrecruit=1
	recruit=Spectre,Revenant,Soul Shooter
	team_name=undead
	{GOLD 200 350 450}
		[ai]
		recruitment_pattern=scout,fighter,fighter,scout,fighter,archer,fighter
		{NO_SCOUTS}
		[/ai]
	[/side]
	
	[side]
	type=Lich
	description=Mal-Xakralan
	side=6
	canrecruit=1
	recruit=Necrophage,Revenant,Soul Shooter,Blood Bat
	team_name=undead
	{GOLD 200 350 450}
		[ai]
		recruitment_pattern=scout,fighter,fighter,scout,fighter,archer,fighter
		{NO_SCOUTS}
		[/ai]
	[/side]
	
	[side]
	type=Lich
	description=Mal-Uknalu
	side=7
	canrecruit=1
	recruit=Nightgaunt,Revenant,Soul Shooter
	team_name=undead
	{GOLD 200 350 450}
		[ai]
		recruitment_pattern=scout,fighter,fighter,scout,fighter,archer,fighter
		{NO_SCOUTS}
		[/ai]
	[/side]

#define EASTINV_GUARD X Y
[unit]
type=Wall Guard
side=1
x={X}
y={Y}
[/unit]
#enddef

#define TERRAIN_Y
#argh!!! terrain= should be a filter! (or is it? this might have all been pointless... :( )
x=10-13,23,24,25,26,27,28-31,32,39,40,39,38,34,33,32,31,30,29-28,10,11-12,12,13,13-14,15-16,4,5
y=6,6,5,6,5,6,5,4,8-11,11-16,17-18,18,25,26-28,28-29,30-31,31-33,34,27-29,30,31,32,33,34,11-16,17-20
#enddef

	{STARTING_VILLAGES 1 5}
	{STARTING_VILLAGES 2 5}
	{STARTING_VILLAGES 3 5}
	{STARTING_VILLAGES 4 5}

	#start event
	[event]
	name=start
		[recall]
		description=Dacyn
		[/recall]
		[recall]
		description=Owaec
		[/recall]
		[unit]
		description=Konrad
		type=Lord
		side=1
		x=21
		y=20
		[/unit]
		{EASTINV_GUARD 9 7}
		{EASTINV_GUARD 15 6}
		{EASTINV_GUARD 21 6}
		{EASTINV_GUARD 34 4}
		{EASTINV_GUARD 38 7}
		{EASTINV_GUARD 37 19}
		{EASTINV_GUARD 34 23}
		{EASTINV_GUARD 27 35}
		{EASTINV_GUARD 18 34}
		{EASTINV_GUARD 10 26}
		{EASTINV_GUARD 6 21}
		{EASTINV_GUARD 5 11}
		{EASTINV_GUARD 16 17}
		{EASTINV_GUARD 24 17}
		{EASTINV_GUARD 20 23}
	
		[message]
		description=Gweddry
		id=msg_cmpgn_ei_19_01
		message= _ "We will fight soon, my lord. Look, night approaches- they will soon attack. I hope we can hold them off."
		[/message]
		[message]
		description=Konrad
		id=msg_cmpgn_ei_19_02
		message= _ "Very well. But is this... Mal-Ravanal, that you spoke of, is he here?"
		[/message]
		[message]
		description=Gweddry
		id=msg_cmpgn_ei_19_03
		message= _ "I do not think so, but he might be here, hiding."
		[/message]
		[message]
		description=Dacyn
		id=msg_cmpgn_ei_19_04
		message= _ "In any case, the undead are attacking now. Let us hope we can last out the night."
		[/message]
	[/event]

	[event]
	name=moveto
		[filter]
		{TERRAIN_Y}
		side=5,6,7
		[/filter]
		[message]
		description=Gweddry
		id=msg_cmpgn_ei_19_05
		message= _ "Look, the undead are tearing down our defences!"
		[/message]
	[/event]

	[event]
	name=moveto
		[filter]
		{TERRAIN_Y}
		side=5,6,7
		[/filter]
		[terrain]
		x,y=$x1,$y1
		letter=h
		[/terrain]
	[/event]
		
	[event]
	name=die
		[filter]
		description=Konrad II
		[/filter]
		[message]
		description=Konrad II
		id=msg_cmpgn_ei_19_06
		message= _ "I have died, and with me the city shall fall."
		[/message]
		[endlevel]
		result=defeat
		[/endlevel]
	[/event]

	[event]
	name=time over
		[message]
		description=Dacyn
		id=msg_cmpgn_ei_19_07
		message= _ "Look, the sun has risen. The undead are retreating."
		[/message]
		[unit]
		type=Lich
		side=9
		description=Messenger of Doom
		x=20
		y=1
		[/unit]
		[message]
		description=Messenger of Doom
		id=msg_cmpgn_ei_19_08
		message= _ "I come bearing a message from my leader:"
		[/message]
		[message]
		description=Dacyn
		id=msg_cmpgn_ei_19_09
		message= _ "Very well, you may read it. (it might tell us something useful)."
		[/message]
		[message]
		description=Messenger of Doom
		id=msg_cmpgn_ei_19_10
		message= _ "He says: Well, you have defeated some of my captains. Good job. But that was only a small fraction of my horde. It would be very easy for me to defeat you. But I don't think it would do justice to my power. I mean my own power, not the power of my legions. And that brings me to my second point. You, Gweddry, as a commander, are a coward. You claim to have defeated my lord's captains, but it was really your hordes, not you."
		[/message]
		[message]
		description=Gweddry
		id=msg_cmpgn_ei_19_11
		message= _ "What is the point of this message? All you do is insult us!"
		[/message]
		[message]
		description=Messenger of Doom
		id=msg_cmpgn_ei_19_12
		message= _ "The point is that Gweddry could not have defeated my lord's minions without the help of his slaves! I doubt Gweddry could even last two seconds in actual combat. And my Lord will prove it. He challenges you, Gweddry, to a contest, a battle."
		[/message]
		[message]
		description=Gweddry
		id=msg_cmpgn_ei_19_13
		message= _ "What are his terms? I won't accept anything obviously weighted towards his victory!"
		[/message]
		[message]
		description=Messenger of Doom
		id=msg_cmpgn_ei_19_14
		message= _ "That only proves you are a coward. Anyway, these are his terms: You pick your six best warriors and I will pick my six best. Then we will fight, to the death, until either you or he is destroyed!"
		[/message]
		[message]
		description=Owaec
		id=msg_cmpgn_ei_19_22
		message= _ "Gweddry, I don't think you should accept. He will bring more than seven undead to the battle; he will bring a whole army!"
		[/message]
		[message]
		description=Dacyn
		id=msg_cmpgn_ei_19_23
		message= _ "Well, I think you should accept. This at least guarantees a somewhat fair fight, and otherwise we will have to face the whole undead army."
		[/message]
		[message]
		description=Messenger of Doom
		id=msg_cmpgn_ei_19_24
		message= _ "I will simplify your choice. Accept, or face the onslaught of my lord's hordes, like the coward that you are."
		[/message]
		[message]
		description=Gweddry
		id=msg_cmpgn_ei_19_25
		message= _ "Hmm..."
			[option]
			name="I'll accept this duel, and prove I am not a coward once and for all."
				[command]
					[endlevel]
					result=victory
					next_scenario=Duel
					[/endlevel]
				[/command]
			[/option]
			[option]
			name="I'm not accepting a duel which you would obviously cheat in. I refuse!"
				[command]
					[endlevel]
					result=victory
					next_scenario=Reject
					[/endlevel]
				[/command]
			[/option]
		[/message]
	[/event]
[/scenario]

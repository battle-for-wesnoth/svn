{scenarios/Son_Of_The_Black_Eye/utils.cfg}
{utils.cfg}


  [scenario]
    name="Saving Inarix"
    id="Saving_Inarix"
    map=orc-map9
    turns=30
    
    {AFTERNOON}
    {DUSK}
    {FIRST_WATCH}
    {SECOND_WATCH}
    {DAWN}
    {MORNING}

    next_scenario="Clash_of_armies"

    music="wesnoth-2.ogg"

    objectives="
Victory:
@Bring at least five lizardmen to the fort on river Gork
Defeat:
#Death of Kapou'e
#Death of Grüü
#Death of Inarix
#Death of more than 5 lizardmen"

    [side]
      type=Orcish Ruler
      description=Kapou'e
      side=1
      canrecruit=1
      controller=human
      recruit= Wolf Rider, Orcish Grunt, Troll Whelp, Orcish Archer
      team_name=Kapoue
      gold=100
    [/side]

    [side]
      race=Elf
      type=Elvish Champion
      description=Mkel
      side=2
      canrecruit=1
      aggression=1.0
      [target]
	type=Lizardman
	value=100
      [/target]
      recruit=Elvish Fighter, Elvish Archer, Elvish Shaman, Elvish Scout
      recruitment_pattern=scout, scout, fighter, fighter, fighter, healer, archer
      team_name=vilains
      {GOLD 100, 150, 250}
      {INCOME 15, 30, 45}
    [/side]

    [side]
      race=Dwarf
      type=Dwarvish Steelclad
      description=Oumph
      side=3
      canrecruit=1
      aggression=1.0
      villages_per_scout=10
      [target]
	type=Lizardman
	value=100
      [/target]
      recruit=Dwarvish Fighter, Dwarvish Thunderer, Footpad, Bandit
      recruitment_pattern=scout, fighter, fighter, fighter, archer
      team_name=vilains
      {GOLD 100, 150, 200}
      {INCOME 15, 30, 45}
    [/side]

    [bigmap]
      image=sotbe/map3.png
      {DOT 385 190}
      {DOT 412 194}
      {DOT 429 188}
      {DOT 452 180}
      {CROSS 463 171}
    [/bigmap]

    [event]
      name=prestart
      [unit]
	type="Orcish Slayer"
	description="Plonk"
	x=27
	y=3
      [/unit]
      {RECALL Grüü}
      {ELVISH_FIGHTER_G 24 11}
      {ELVISH_ARCHER_G 25 11}
      [set_variable]
	name=elvish_casualties
	value=0
      [/set_variable]
    [/event]

    [event]
      name=start
      [message]
	description="Plonk"
	id=msg_orc_10_1
	message="Reinforcements, at least!  Whoever you are, you are welcome in Prestim!  The fortified bridge over the Gork river has been taken this morning by a small commando of elves, we already tried to assault it twice without success."
      [/message]
      [message]
	description="Grüü"
	id=msg_orc_10_2
	message="Ah!  They are no match against my mace."
      [/message]
      [message]
	description="Plonk"
	id=msg_orc_10_3
	message="There is worse, our scouts reported that our lizardmen allies led by Inarix are still blocked on the other side of the river some miles away. They won't be able to cross the river."
      [/message]
      [message]
	description="Plonk"
	id=msg_orc_10_4
	message="Elves and dwarves have joined humans against us and are camping near.  Humans will arrive soon.  We must destroy the southern bridge on the river."
      [/message]
      [message]
	description="Kapou'e"
	id=msg_orc_10_5
	message="We must do something!"
      [/message]
      [message]
	description="Grüü"
	id=msg_orc_10_6
	message="I know what we must do.  Kill elves and help Inarix cross."
      [/message]
      [message]
	description="Plonk"
	id=msg_orc_10_7
	message="It won't be that easy!  Our enemies are well entrenchered.  And don't forget, we will sabotage the southern bridge as soon as the bulk of Lizardmen army will have crossed!"
      [/message]
      [message]
	description="Plonk"
	id=msg_orc_10_8
	message="Each warrior trapped on the bridge or on the other side of the river will perish!"
      [/message]
      [set_variable]
	name=lizards_safe
	value=0
      [/set_variable]
    [/event]

    [event]
      name=turn 2
      {LIZARDMAN 8 42 Inarix}
      {LIZARDMAN 8 42 Xortex}
      {LIZARDMAN 8 42 Merlex}
      {LIZARDMAN 8 42 Lagunax}
      {LIZARDMAN 8 42 Lux}
      {LIZARDMAN 8 42 Otomox}
      {LIZARDMAN 8 42 Emax}
      {LIZARDMAN 8 42 Fabix}
      {LIZARDMAN 8 42 Morganx}
      {LIZARDMAN 8 42 Stelianx}
      [message]
	description="Inarix"
	id=msg_orc10_10
	message="Here we are, my friends.  Earl Lanbec'h and his kind is at on our tail."
      [/message]
    [/event]

    [event]
      first_time_only="no"
      name="new turn"
      [if]
	[variable]
	  equals="1"
	  name="lizards_safe"
	[/variable]
	[then]
	  [sound]
	    name=gunshot.wav
	  [/sound]
	  [delay]
	    time=200
	  [/delay]
	  [sound]
	    name=gunshot.wav
	  [/sound]
	  [delay]
	    time=200
	  [/delay]
	  [sound]
	    name=gunshot.wav
	  [/sound]
	  [delay]
	    time=500
	  [/delay]
	  [sound]
	    name=fire.wav
	  [/sound]
	  [terrain]
	    x=21,22,23
	    y=13,12,12
	    letter=c
	  [/terrain]
	  [kill]
	    x=21,22,23
	    y=13,12,12
	    animate=yes
	  [/kill]
	  [kill]
	    side=1
	    x=1-24,24-40
	    y=12-40,13-40
	    animate=yes
	  [/kill]
	  [endlevel]
	    result=victory
	    bonus=yes
	  [/endlevel]
	[/then]
      [/if]
      [store_unit]
	variable="lizards"
	[filter]
	  type="Lizardman"
	  x="1-39"
	  y="1-11"
	[/filter]
      [/store_unit]
      [set_variable]
	name="i"
	value="0"
      [/set_variable]
      [while]
	[variable]
	  less_than="$lizards.length"
	  name="i"
	[/variable]
	[do]
	  [set_variable]
	    add="1"
	    name="i"
	  [/set_variable]
	[/do]
      [/while]
      [if]
	[variable]
	  greater_than="4"
	  name="i"
	[/variable]
	[then]
	  [message]
	    description="Kapou'e"
	    id=msg_orc10_20
	    message="Hurry up!  The southern bridge is going to explode! Retreat! "
	  [/message]
	  [set_variable]
	    name="lizards_safe"
	    value="1"
	  [/set_variable]
	[/then]
      [/if]
    [/event]

    [event]
      name=die
      [filter]
        description=Inarix
      [/filter]
      [message]
	description="Kapou'e"
	id=msg_orc10_30
	message="Without Inarix to lead his lizardmen, there is no hope."
      [/message]
      [endlevel]
	result=defeat
      [/endlevel]
    [/event]

    [event]
      name=die
      first_time_only=no
      [filter]
	type=Lizardman
      [/filter]
      [command]
	[set_variable]
	  name=lizard_casualties
	  add=1
	[/set_variable]
      [/command]
      [command]
	[if]
	  [variable]
	    name=lizard_casualties
	    numerical_equals=6
	  [/variable]
	  [then]
	    [message]
	      description="Kapou'e"
	      id=msg_orc10_31
	      message="We had too much casualties to be able to resist to humans, we must surrender."
	    [/message]
	    [endlevel]
	      result=defeat
	    [/endlevel]
	  [/then]
	[/if]
      [/command]
    [/event]

    {scenarios/Son_Of_The_Black_Eye/deaths.cfg}

  [/scenario]


[scenario]
	id=A_Harrowing_Escape
	name= _ "A Harrowing Escape"
	map_data="{maps/The_Rise_of_Wesnoth/A_Harrowing_Escape}"
	turns=45

	{DAWN}
	{MORNING}
	{AFTERNOON}
	{DUSK}
	{FIRST_WATCH}
	{SECOND_WATCH}

	next_scenario=The_River_Road
	
	music=wesnoth-7.ogg
	
	objectives= _ "
Victory:
@Defeat Both Enemies
Defeat:
#Death of Prince Haldric or
#Turns run out"

	{scenarios/The_Rise_of_Wesnoth/trow-deaths.cfg}
	{scenarios/The_Rise_of_Wesnoth/trow-macros.cfg}

	[story]
		[part]
			background=maps/the_green_isle.png
			show_title=yes
			{DOT 260 255}
			{DOT 265 265}
			{DOT 275 275}
			{DOT 290 285}
			{CROSS 295 286}
		[/part]
	[/story]

	
	[side]
		type=Noble Commander
		description=Prince Haldric
		side=1
		canrecruit=1
		controller=human
		team_name=Haldric
	[/side]
	
	[side]
		type=Orcish Ruler
		description=Tan-Schmog
		side=2
		canrecruit=1
		{GOLD 90 145 250}
		team_name=orcs
		recruit=Orcish Archer, Orcish Assassin, Orcish Grunt, Wolf Rider
		[ai]
			{NO_SCOUTS}
			recruitment_pattern=scout,scout,fighter,fighter,archer
			recruitment_ignore_bad_movement=yes
			passive_leader=yes 
		[/ai]
		[ai] 
			time_of_day=first_watch,second_watch 
			aggression=0.75
			caution=0.0
			grouping=no
		[/ai]
	[/side]
	
	[side]
		type=Orcish Ruler
		description=Tan-NauVong
		side=3
		canrecruit=1
		{GOLD 90 145 250}
		team_name=orcs
		recruit=Orcish Archer, Orcish Assassin, Orcish Grunt, Wolf Rider
		[ai]
			{NO_SCOUTS}
			recruitment_pattern=scout,scout,fighter,fighter,archer
			recruitment_ignore_bad_movement=yes
			passive_leader=yes 
		[/ai]
		[ai] 
			time_of_day=first_watch,second_watch 
			aggression=0.75
			caution=0.0
			grouping=no
		[/ai]
	[/side]

	[event]
		name=prestart

		{PUT_IMG (items/signpost.png) 23 38}
		{PUT_IMG (items/signpost.png) 13 7}
#ifdef EASY
		{GUARD_UNIT (Orcish Grunt) (Snagakhan) 2 17 37}
		{GUARD_UNIT (Orcish Grunt) (Knafakhan) 3 19 36}
#endif
#ifdef NORMAL
		{GUARD_UNIT (Orcish Warrior) (Snagakhan) 2 17 37}
		{GUARD_UNIT (Orcish Warrior) (Knafakhan) 3 19 36}
#endif

#ifdef HARD
		{GUARD_UNIT (Orcish Warrior) (Snagakhan) 2 17 37}
		{GUARD_UNIT (Orcish Warrior) (Knafakhan) 3 19 36}
		{GUARD_UNIT (Orcish Warrior) (Urgtelfar) 2 6 23}
		{GUARD_UNIT (Orcish Warrior) (Gruumogth) 3 8 22}
#endif
		[recall]
			description=Lady Outlaw
		[/recall]
	[/event]

	[event]
		name=start
		[message]
			id=msgT2_1
			description=Prince Haldric
			message= _ "Argh, the Orcish vanguard must have flanked us even further to the East! They're already holding the mouth of the pass. We have to get out of the mountain pass before winter comes or we're all dead meat!"
		[/message]
		
		[message]
			id=msgT2_2
			description=Prince Haldric
			message= _ "Father, I wish you were here. . ."
		[/message]
		
		[message]
			id=msgT2_3
			description=Lady Outlaw
			message= _ "I'd drop the sentiment, and pick up your sword. There's plenty of fighting ahead of us!"
		[/message]
		
		[message]
			id=msgT2_4
			description=Tan-Schmog
			message= _ "You won't get much further boy. Grrrr!"
		[/message]
	[/event]
	
	[event]
		name=moveto
		[filter]
			side=1
			x=8
			y=5
		[/filter]
		
		[message]
			id=msgT2_5
			speaker=unit
			message= _ "Who goes there?"
		[/message]
		
		{UNIT (Dwarvish Steelclad) (Burin the Lost) 1 8 5}
		
		[message]
			id=msgT2_6
			speaker=Burin the Lost
			message= _ "Burin, Burin the Lost. Who be yee?"
		[/message]
		
		[message]
			id=msgT2_7
			description=Prince Haldric
			message= _ "I'm Prince Haldric, we have little time to talk. We must make haste through the pass. . . What are you?"
		[/message]
		
		[message]
			id=msgT2_8
			speaker=Burin the Lost
			message= _ "I'm a Dwarf! Damn fool of a boy! I got lost while exploring deep underground, almost a century ago. I've never found my way home. But it seems nice enough here."
		[/message]
		
		[message]
			id=msgT2_9
			description=Prince Haldric
			message= _ "Nice? The Orcs have come and we must flee!"
		[/message]
		
		[message]
			id=msgT2_10
			speaker=Burin the Lost
			message= _ "Orcs! It's been a long time since I felt the satisfying crunch of one of those under my Axe. Time for a fight!"
		[/message]
		
		[message]
			id=msgT2_11
			description=Prince Haldric
			message= _ "You've fought Orcs before?"
		[/message]
		
		[message]
			id=msgT2_12
			speaker=Burin the Lost
			message= _ "Fool Boy! Where did you grow up? Enough of this, let's go get some Orcs!"
		[/message]
		
	[/event]
	
	[event]
		name=time over
		[message]
			id=msgT2_13
			description=Prince Haldric
			message= _ "We're trapped in the pass! I can see their re-enforcements! All is lost! Is that. . . Is that snow. . . We're so dead!"
		[/message]
	[/event]
	
	[event]
		name=moveto
		[filter]
			side=1
			x=23
			y=38
		[/filter]
		[message]
			id=msgT2_14
			speaker=narrator
			message= _ "SE - The River Road. SW - The Midlands."
		[/message]
	[/event]
	
	[event]
		name=moveto
		[filter]
			side=1
			x=13
			y=7
		[/filter]
		[message]
			id=msgT2_15
			speaker=narrator
			message= _ "GO HOME! AIN'T NUTTIN TO SEE HEER!"
		[/message]
	[/event]

#define ESCAPE_VICTORY
		[message]
			id=msgT2_15a
			description=Prince Haldric
			message= _ "Now, should I go South-East on the River Road, or South-West through the midlands? The River Road crosses the Swamp of Esten, so I doubt that even Orcs would go there. The Midlands were nice, but who knows what's going on there now."
			
			[option]
				id=river_road
				message= _ "I think I'll take the River Road. . ."
				[command]
					[message]
						id=msgT2_16a
						description=Lady Outlaw
						message= _ "Good. The Midlands are probably an Orc infested ruin by now."
					[/message]
		
					[message]
						id=msgT2_16b
						speaker=Burin the Lost
						message= _ "SWAMP! I'm under 5 feet tall, and I don't float! Argh, have it your way."
					[/message]
					[endlevel]
						result=victory
						bonus=yes
						next_scenario=The_River_Road
					[/endlevel]
				[/command]
			[/option]
			[option]
				id=midlands
				message= _ "We'll go through the Midlands. . ."
				[command]
					[message]
						id=msgT2_16c
						description=Lady Outlaw
						message= _ "I suspect that the Midlands might be in ruins by now."
					[/message]
		
					[message]
						id=msgT2_16d
						speaker=Burin the Lost
						message= _ "It's better than the swamp, I'm under 5 feet tall, and I don't float! Besides, I'd rather enjoy meeting more orcs."
					[/message]
					[endlevel]
						result=victory
						bonus=yes
						next_scenario=The_Midlands
					[/endlevel]
				[/command]
			[/option]
		[/message]
#enddef

	[event]
		name=die
		[filter]
			description=Tan-Schmog
		[/filter]
		
		[filter_second]
			side=1
		[/filter_second]
		
		{LOOT 50 1}
		
		[if]
			[variable]
			name=second_orc_dead
			equals=yes
			[/variable]
			[then]
			{ESCAPE_VICTORY}
			[/then]
			[else]
				[set_variable]
				name=first_orc_dead
				value=yes
				[/set_variable]
				#Give them a nasty surprise
#ifdef EASY
				[gold]
					side=3
					amount=60
				[/gold]
				{UNIT (Orcish Slayer) (Hashnak) 3 25 40}

#else
				[gold]
					side=3
					amount=90
				[/gold]
				
				{UNIT (Orcish Slayer) (Hashnak) 3 25 40}
				{UNIT (Orcish Assassin) (Grork) 3 24 40}
				{UNIT (Orcish Assassin) (Vigdish) 3 26 40}

#endif
				[message]
					id=msgT2_17
					speaker=Tan-NauVong
					message= _ "Come and get it!"
				[/message]
				[message]
					id=msgT2_18
					speaker=Hashnak
					message= _ "Die human."
				[/message]
				[message]
					id=msgT2_19
					speaker=Prince Haldric
					message= _ "Uh-oh!"
				[/message]
			[/else]
		[/if]
	[/event]

	[event]
		name=die
		[filter]
			description=Tan-NauVong
		[/filter]
		
		[filter_second]
			side=1
		[/filter_second]
		
		{LOOT 50 1}
		
		[if]
			[variable]
			name=first_orc_dead
			equals=yes
			[/variable]
			[then]
			{ESCAPE_VICTORY}
			[/then]
			[else]
				[set_variable]
				name=second_orc_dead
				value=yes
				[/set_variable]
				#Give them a nasty surprise
				
#ifdef EASY
				[gold]
					side=2
					amount=60
				[/gold]
				
				{UNIT (Orcish Slayer) (Hashnak) 2 25 40}
#else
				[gold]
					side=2
					amount=90
				[/gold]
				
				{UNIT (Orcish Slayer) (Hashnak) 2 25 40}
				{UNIT (Orcish Assassin) (Grork) 2 24 40}
				{UNIT (Orcish Assassin) (Vigdish) 2 26 40}
#endif
				[message]
					id=msgT2_20
					speaker=Tan-Schmog
					message= _ "I'll not go so easily!"
				[/message]
				[message]
					id=msgT2_21
					speaker=Hashnak
					message= _ "Die human."
				[/message]
				[message]
					id=msgT2_22
					speaker=Prince Haldric
					message= _ "Uh-oh!"
				[/message]
			[/else]
		[/if]
	[/event]
	
	[event]
		name=victory
		[message]
			id=msgT2_23
			speaker=Prince Haldric
			message= _ "We've escaped the pass. Well, at least I know that the orcs can be beaten. Hmmm, I guess that this is that last I'll see of my home. . . and my Father. (Sigh)"
		[/message]
		[message]
			id=msgT2_24
			speaker=Prince Haldric
			message= _ "We should make our way to Southbay. It is the largest city on the Isle. We should be able to make a stand there. Failing that, there's always Clearwater Port."
		[/message]
		{CLEAR_VARIABLE first_orc_dead}
		{CLEAR_VARIABLE second_orc_dead}
	[/event]
	
[/scenario]

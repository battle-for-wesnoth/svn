[scenario]
	id=Troll_Hole
	textdomain=wesnoth-trow
	name= _ "Troll Hole"
	map_data="{maps/The_Rise_of_Wesnoth/Troll_Hole}"
	turns=36

	{UNDERGROUND}

	next_scenario=Elf_Lords
	bonus=yes
	
	music=underground.ogg
	
	objectives= _ "
Victory:
@Defeat all Enemies
Defeat:
#Death of Prince Haldric or
#Death of Lady Jessica or
#Turns run out"

	{scenarios/The_Rise_of_Wesnoth/trow-deaths.cfg}
	{scenarios/The_Rise_of_Wesnoth/trow-macros.cfg}

	[story]
		[part]
			background=maps/the_great_continent.png
			show_title=yes
			{DOT 315 180}
			{DOT 320 205}
			{DOT 340 215}
			{DOT 365 215}
			{DOT 390 215}
			{DOT 415 215}
			{CROSS 425 226}
		[/part]
	[/story]

	[side]
		type=Noble Commander
		description=Prince Haldric
		side=1
		canrecruit=1
		controller=human
		shroud=yes
		team_name=Haldric
		{INCOME 8 4 2}
	[/side]
	
	[side]
		type=Troll Warrior
		description=Erart
		side=2
		canrecruit=1
		{GOLD 90 160 240}
		{INCOME 4 8 12}
		team_name=Troll
#ifdef EASY
		recruit=Troll Whelp
#else
		recruit=Troll Whelp,Troll
#endif
		[ai]
			{NO_SCOUTS}
			recruitment_ignore_bad_movement=yes
			recruitment_pattern=fighter
			aggression=0.75
		[/ai]
	[/side]

	[side]
		type=Troll Warrior
		description=Raol
		side=3
		canrecruit=1
		{GOLD 90 160 240}
		{INCOME 4 8 12}
		team_name=Troll
#ifdef EASY
		recruit=Troll Whelp
#else
		recruit=Troll Whelp,Troll
#endif
		[ai]
			{NO_SCOUTS}
			recruitment_ignore_bad_movement=yes
			recruitment_pattern=fighter
			aggression=0.75
		[/ai]
	[/side]
	
	[side]
		type=Troll Warrior
		description=Rilg
		side=4
		canrecruit=1
		{GOLD 90 160 240}
		{INCOME 4 8 12}
		team_name=Troll
#ifdef EASY
		recruit=Troll Whelp
#else
		recruit=Troll Whelp,Troll
#endif
		[ai]
			{NO_SCOUTS}
			recruitment_ignore_bad_movement=yes
			recruitment_pattern=fighter
			aggression=0.75
		[/ai]
	[/side]
	
	[side]
		type=Troll Warrior
		description=Gulg
		side=5
		canrecruit=1
		{GOLD 90 160 240}
		{INCOME 4 8 12}
		team_name=Troll
#ifdef EASY
		recruit=Troll Whelp
#else
		recruit=Troll Whelp,Troll
#endif
		[ai]
			{NO_SCOUTS}
			recruitment_ignore_bad_movement=yes
			recruitment_pattern=fighter
			aggression=0.75
		[/ai]
	[/side]

	{scenarios/The_Rise_of_Wesnoth/trow-nlmsg.cfg}
	
	[event]
	name=prestart

		{STARTING_VILLAGES 2 10}
		{STARTING_VILLAGES 3 10}
		{STARTING_VILLAGES 4 10}
		{STARTING_VILLAGES 5 10}

		{PUT_IMG (terrain/rocks.png) 3 14}
		{PUT_IMG (terrain/rocks.png) 25 19}
		{PUT_IMG (terrain/rocks.png) 15 3}
		{PUT_IMG (terrain/rocks.png) 17 27}

		{UNIT (Tentacle of the Deep) (Tentacle of the Deep) 2 15 11}
		{UNIT (Tentacle of the Deep) (Tentacle of the Deep) 3 15 20}

#ifdef MEDIUM
		{UNIT (Tentacle of the Deep) (Tentacle of the Deep) 4 11 15}
		{UNIT (Tentacle of the Deep) (Tentacle of the Deep) 5 19 17}
#endif
#ifdef HARD
	
		{UNIT (Tentacle of the Deep) (Tentacle of the Deep) 4 11 15}
		{UNIT (Tentacle of the Deep) (Tentacle of the Deep) 5 19 17}
		{UNIT (Tentacle of the Deep) (Tentacle of the Deep) 2 11 17}
		{UNIT (Tentacle of the Deep) (Tentacle of the Deep) 3 19 15}
#endif

		{RANDOM 1..4}
		[if]
			[variable]
			name=random
			numerical_equals=1
			[/variable]
			[then]
				[kill]
				description=Erart
				[/kill]
				{GUARD_UNIT (Giant Spider) (Fang) 3 5 5}
				[kill]
				description=Raol
				[/kill]
				{GUARD_UNIT (Giant Spider) (Fang) 2 25 5}
			[/then]
		[/if]
		[if]
			[variable]
			name=random
			numerical_equals=2
			[/variable]
			[then]
				[kill]
				description=Raol
				[/kill]
				{GUARD_UNIT (Giant Spider) (Fang) 2 25 5}
				[kill]
				description=Rilg
				[/kill]
				{GUARD_UNIT (Giant Spider) (Fang) 5 5 25}
			[/then]
		[/if]
		[if]
			[variable]
			name=random
			numerical_equals=3
			[/variable]
			[then]
				[kill]
				description=Rilg
				[/kill]
				{GUARD_UNIT (Giant Spider) (Fang) 5 5 25}
				[kill]
				description=Gulg
				[/kill]
				{GUARD_UNIT (Giant Spider) (Fang) 4 25 25}
			[/then]
		[/if]
		[if]
			[variable]
			name=random
			numerical_equals=4
			[/variable]
			[then]
				[kill]
				description=Gulg
				[/kill]
				{GUARD_UNIT (Giant Spider) (Fang) 4 25 25}
				[kill]
				description=Erart
				[/kill]
				{GUARD_UNIT (Giant Spider) (Fang) 3 5 5}
			[/then]
		[/if]
		
		[recall]
			description=Lady Jessica
		[/recall]
		[recall]
			description=Burin the Lost
		[/recall]
		[recall]
			description=Sir Ruddry
		[/recall]
		
		[recall]
			description=Sir Ladoc
		[/recall]
		
		[recall]
			description=Minister Edmond
		[/recall]
	[/event]
	
	[event]
		name=start
		[message]
			id=msgT16a_1
			speaker=narrator
			message= _ "It isn't long before Haldric and his companions enter the Brown Hills. An elven guide leads them to a gaping cave mouth, and they descend into the darkness."
		[/message]
		
		[message]
			id=msgT16a_2
			speaker=Prince Haldric
			message= _ "So, does anybody know anything about trolls?"
		[/message]
		
		[message]
			id=msgT16a_3
			speaker=Burin the Lost
			message= _ "I indeed do. They are green, and mean, and will try to crush you like a bug. They heal very quickly."
		[/message]
		
		[message]
			id=msgT16a_4
			speaker=Lady Jessica
			message= _ "Hmm. . . Do we really need to know that much about the trolls? I think it's safe to say that the elves wouldn't have sent us down here if they were at all friendly."
		[/message]
		
		[message]
			id=msgT16a_5
			speaker=Prince Haldric
			message= _ "Fair Enough. Well, let's get them!"
		[/message]
	[/event]
	
	[event]
		name=time over
		[message]
			id=msgT16a_6
			description=Prince Haldric
			message= _ "We have failed. . . More of the Troll's kin are arriving through the entrance."
		[/message]
	[/event]
	
	[event]
		name=die
		[filter]
			description=Erart
		[/filter]
		{LOOT 50 1}
	[/event]
	
	[event]
		name=die
		[filter]
			description=Raol
		[/filter]
		{LOOT 50 1}
	[/event]
	
	[event]
		name=die
		[filter]
			description=Rilg
		[/filter]
		{LOOT 50 1}
	[/event]
	
	[event]
		name=die
		[filter]
			description=Gulg
		[/filter]
		{LOOT 50 1}
	[/event]
	
	[event]
		name=victory
		[message]
			id=msgT16a_7
			description=Prince Haldric
			message= _ "The trolls are beaten. No wonder why the elves are getting us to do their dirty linens."
		[/message]
		
		{VARIABLE_OP num_done add 1}
		
		[set_variable]
			name=troll_hole
			value=1
		[/set_variable]
		
		[set_variable]
			name=last_done
			value="Hole"
		[/set_variable]
		
		{CLEAR_VARIABLE random}
	[/event]
	
[/scenario]
